# C++çš„ç±»



## ç®€ä»‹

ç±»ä¸­åŒ…å«ï¼š

- **å±æ€§** åˆç§° æˆå‘˜å±æ€§ã€æˆå‘˜å˜é‡
- **è¡Œä¸º** åˆç§° æˆå‘˜å‡½æ•°ã€æˆå‘˜æ–¹æ³•

**å±æ€§**å’Œ**è¡Œä¸º**ç»Ÿç§°ä¸º**æˆå‘˜**

```c++
class Student{
    public:
    
    //å±æ€§ åˆç§° æˆå‘˜å±æ€§ã€æˆå‘˜å˜é‡
    string name;
    string number;

    //è¡Œä¸º åˆç§° æˆå‘˜å‡½æ•°ã€æˆå‘˜æ–¹æ³•
    void show()
    {
        cout<<"name:"<<name<<endl;
        cout<<"number:"<<number<<endl;
    }
};
```



## è®¿é—®æƒé™

å…±æœ‰ **3** ç§

| è®¿é—®æƒé™            | ç±»å†…å¯å¦è®¿é—® | ç±»å¤–å¯å¦è®¿é—® | ï¼ˆç»§æ‰¿ä¸­ï¼‰å„¿å­å¯å¦è®¿é—®çˆ¶äº²çš„å†…å®¹ |
| ------------------- | ------------ | ------------ | -------------------------------- |
| å…¬å…±æƒé™`public`    | Yes          | Yes          | Yes                              |
| ä¿æŠ¤æƒé™`protected` | Yes          | No           | Yes                              |
| ç§æœ‰æƒé™`private`   | Yes          | No           | No                               |



## struct vs class

**C è¯­è¨€**çš„ `struct` åªèƒ½åŒ…å« **å˜é‡**ï¼Œ**ä¸èƒ½åŒ…å«å‡½æ•°**ã€‚

åœ¨ **C++** ä¸­ï¼Œ`struct` å’Œ `class` **å‡ ä¹ä¸€æ ·**ï¼Œå®ƒä»¬éƒ½å¯ä»¥åŒ…å« **å˜é‡ï¼ˆæ•°æ®æˆå‘˜ï¼‰** å’Œ **å‡½æ•°ï¼ˆæˆå‘˜å‡½æ•°ï¼‰**ï¼Œä¸»è¦çš„åŒºåˆ«åœ¨äº **é»˜è®¤è®¿é—®æƒé™ä¸åŒ**ã€‚

1. `struct` é»˜è®¤æ˜¯å…¬å…±æƒé™`public`
2. `class`é»˜è®¤æ˜¯ç§æœ‰æƒé™`private`

ç¤ºä¾‹ï¼š

```c++
struct Person1{
    string name;//é»˜è®¤æ˜¯å…¬å…±æƒé™ public
};

class Person2{
    string name;//é»˜è®¤æ˜¯ç§æœ‰æƒé™ private
};

int main()
{
    Person1 p1;
    Person2 p2;
    string myName="aaa";

    p1.name=myName;//å…¬å…±æƒé™ï¼Œå¯ä»¥è®¿é—®
    p2.name=myName;//ç§æœ‰æƒé™ï¼Œä¸å¯ä»¥è®¿é—®ï¼Œä¼šæŠ¥é”™ï¼

    return 0;
}
```



å¥½å¤„ï¼š

- å¯ä»¥æ§åˆ¶è®¿é—®æƒé™ï¼ˆå¯ä¸å¯ä»¥è¯»ã€å†™ï¼‰
- å¯ä»¥æ£€æµ‹å†™å…¥å€¼çš„æœ‰æ•ˆæ€§

ç¤ºä¾‹

```c++
class Person{
private:
    string name;
    int age;
public:
    string getName()//è¯»name
    {
        return name;
    }

    void setAge(int in_age)//å†™age
    {
        //æ£€æµ‹å†™å…¥å€¼çš„æœ‰æ•ˆæ€§
        //ä¸æ»¡è¶³æ¡ä»¶ï¼Œåˆ™ä¸èƒ½å†™å…¥
        if(in_age<0)
        {
            cout<<"è¾“å…¥å¼‚å¸¸"<<endl;
        }
        age=in_age;
    }
    int getAge()//è¯»age
    {
        return age;
    }
};
```



## ä¾‹å­

> Pointç±»
>
> æœ‰ä¸€ä¸ªæ„é€ å‡½æ•°
>
> æœ‰ä¸€ä¸ª**é™æ€**æ•°æ®æˆå‘˜ï¼Œcountï¼Œè®°å½•äº†ä¸€å…±åˆ›å»ºäº†å¤šå°‘ä¸ªpointå¯¹è±¡
> æœ‰ä¸¤ä¸ªåŸºæœ¬å±æ€§xï¼Œyï¼Œåˆ†åˆ«è®°å½•äº†xå’Œyè½´çš„åæ ‡ï¼Œxï¼Œyçš„åˆå§‹å€¼ä¸º0ï¼›
> æœ‰2ä¸ªæ–¹æ³•ï¼š
>
> - judgeå¯ä»¥åˆ¤æ–­ä¸‰ä¸ªç‚¹æ˜¯å¦åœ¨ä¸€æ¡ç›´çº¿ä¸Š
> - printå¯ä»¥æ‰“å°å‡ºç‚¹çš„åæ ‡(x,y)
>
> è°ƒç”¨æ–¹å¼ï¼š
>
> - `Point p1(x, y);`
> -  `Point::count`
> -  `p1.judge(p2, p3)`
> - `p1.print();`



```c++
class Point
{
private:
	double x, y;
	
public:
	Point(double x0,double y0):x(x0),y(y0)
	{
		count++;
	}//æ„é€ å‡½æ•°
	
	bool judge(Point p2, Point p3);
	void print();
    
	static int count;//é™æ€æ•°æ®æˆå‘˜
};

int Point::count = 0;//ç±»å†…å®šä¹‰çš„é™æ€å˜é‡è¦åœ¨ç±»å¤–åˆå§‹åŒ–

bool Point::judge(Point p2, Point p3)//åˆ¤æ–­3ç‚¹æ˜¯å¦å…±çº¿
{
	if ((y - p2.y) * (x - p3.x) == (y - p3.y) * (x - p2.x))
	{
		return true;
	}
	else
	{
		return false;
	}
}

void Point::print()
{
	std::cout << '(' << x << ',' << y << ')' << std::endl;
}
```



# å„éƒ¨åˆ†è¯¦ç»†ä»‹ç»



## æ„é€ å‡½æ•°andææ„å‡½æ•°

### 1. **æ„é€ å‡½æ•°ï¼ˆConstructorï¼‰**
#### ä½œç”¨ï¼š

æ„é€ å‡½æ•°æ˜¯åœ¨åˆ›å»ºå¯¹è±¡æ—¶**è‡ªåŠ¨è°ƒç”¨**çš„å‡½æ•°ï¼Œç”¨äº**åˆå§‹åŒ–**å¯¹è±¡çš„æˆå‘˜å˜é‡ï¼Œåˆ†é…èµ„æºç­‰ã€‚æ¯æ¬¡åˆ›å»ºå¯¹è±¡æ—¶ï¼Œæ„é€ å‡½æ•°éƒ½ä¼šè¢«è°ƒç”¨ä¸€æ¬¡ã€‚

#### ç‰¹ç‚¹ï¼š
- **åç§°**ï¼šæ„é€ å‡½æ•°çš„åç§°ä¸**ç±»åç›¸åŒ**ã€‚

- **è¿”å›ç±»å‹**ï¼šæ„é€ å‡½æ•°**æ²¡æœ‰è¿”å›ç±»å‹ï¼Œä¹Ÿä¸è¿”å›ä»»ä½•å€¼**ã€‚ä¹Ÿ**ä¸ç”¨å†™void**

- **è°ƒç”¨æ—¶æœº**ï¼šæ„é€ å‡½æ•°åœ¨å¯¹è±¡**åˆ›å»ºæ—¶** **è‡ªåŠ¨**è°ƒç”¨ã€‚

- **å‚æ•°**ï¼šæ„é€ å‡½æ•°å¯ä»¥æœ‰å‚æ•°ï¼Œä¹Ÿå¯ä»¥æ²¡æœ‰å‚æ•°ï¼ˆæ— å‚æ„é€ å‡½æ•°ï¼‰ã€‚å› æ­¤å¯ä»¥å‘ç”Ÿ**é‡è½½**

  

#### ç§ç±»ï¼š
- **æ— å‚æ„é€ å‡½æ•°**ï¼ˆé»˜è®¤æ„é€ å‡½æ•°ï¼‰ï¼šæ²¡æœ‰å‚æ•°ï¼Œåˆ›å»ºå¯¹è±¡æ—¶è‡ªåŠ¨è°ƒç”¨ã€‚

- **æœ‰å‚æ„é€ å‡½æ•°**ï¼šå¸¦æœ‰ä¸€ä¸ªæˆ–å¤šä¸ªå‚æ•°ï¼Œç”¨äºæ ¹æ®ä¸åŒçš„å‚æ•°åˆå§‹åŒ–å¯¹è±¡ã€‚

- **æ‹·è´æ„é€ å‡½æ•°**ï¼šç”¨äºå¤åˆ¶å·²æœ‰å¯¹è±¡çš„å†…å®¹æ¥åˆ›å»ºä¸€ä¸ªæ–°å¯¹è±¡ï¼Œé€šå¸¸ç”±ç¼–è¯‘å™¨è‡ªåŠ¨è°ƒç”¨ï¼Œæˆ–è€…ä½ å¯ä»¥è‡ªå®šä¹‰å®ƒã€‚ï¼ˆåªæœ‰**1ä¸ª**ï¼‰



#### åˆå§‹åŒ–æ–¹æ³•ï¼š

>å› ä¸ºç±»æ˜¯é€šè¿‡å®ƒçš„æ„é€ å‡½æ•°æ¥åˆå§‹åŒ–çš„ï¼Œ
>
>æ‰€ä»¥ï¼Œç±»çš„åˆå§‹åŒ–æ–¹æ³•ä¹Ÿå°±æ˜¯æ„é€ å‡½æ•°çš„å†™æ³•

å¯¹äº**æ— å‚æ„é€ å‡½æ•°**å’Œ**æœ‰å‚æ„é€ å‡½æ•°**ï¼Œæœ‰2ç§å†™æ³•ï¼š



##### å†™æ³•ä¸€ï¼šé€ä¸€èµ‹å€¼æ³•ï¼ˆä¼ ç»Ÿå†™æ³•ï¼‰

```c++
MyClass(){
        x=0;
        y=0;
    }
MyClass(int xx,int yy){
        x=xx;
        y=yy;
    }
```



##### å†™æ³•äºŒï¼šåˆå§‹åŒ–åˆ—è¡¨ ğŸŒŸ

```c++
MyClass():x(0),y(0){}
MyClass(int xx,int yy):x(xx),y(yy){}
```

> [!NOTE]
>
> æˆå‘˜æ˜¯æŒ‰ç…§ä»–ä»¬åœ¨**ç±»ä¸­å£°æ˜çš„é¡ºåº**è¿›è¡Œåˆå§‹åŒ–çš„ï¼Œè€Œä¸æ˜¯æŒ‰ç…§ä»–ä»¬åœ¨åˆå§‹åŒ–å™¨åˆ—è¡¨å‡ºç°çš„é¡ºåºåˆå§‹åŒ–çš„  
>
> 
>
> å¦‚æœé¡ºåºä¸å½“ï¼Œå¯èƒ½ä¼šæŠ¥é”™ï¼Œä¾‹å¦‚ï¼š
>
> ![image-20250325082020124](C++ç±»çš„ç®€ä»‹.assets/image-20250325082020124-1742862023450-3.png)

> [!IMPORTANT]
>
> **å¿…é¡»ä½¿ç”¨ *æˆå‘˜åˆå§‹åŒ–åˆ—è¡¨* çš„æƒ…å½¢**
>
> 1.**å¸¸é‡æˆå‘˜**ï¼Œå› ä¸ºå¸¸é‡åªèƒ½åˆå§‹åŒ–ä¸èƒ½èµ‹å€¼ï¼Œæ‰€ä»¥å¿…é¡»æ”¾åœ¨åˆå§‹åŒ–å™¨åˆ—è¡¨é‡Œé¢
>
> 2.**å¼•ç”¨ç±»å‹**ï¼Œå¼•ç”¨å¿…é¡»åœ¨å®šä¹‰çš„æ—¶å€™åˆå§‹åŒ–ï¼Œå¹¶ä¸”ä¸èƒ½é‡æ–°èµ‹å€¼ï¼Œæ‰€ä»¥ä¹Ÿè¦ä½¿ç”¨åˆå§‹åŒ–å™¨
>
> 3.**æ²¡æœ‰æ— å‚æ„é€ å‡½æ•°**çš„**ç±»**æˆå‘˜ï¼Œä½¿ç”¨åˆå§‹åŒ–å™¨åˆ—è¡¨å¯ä»¥ä½¿ç”¨**æœ‰å‚æ„é€ å‡½æ•°**åˆå§‹åŒ–



#### è°ƒç”¨æ–¹å¼ï¼š

- æ‹¬å·æ³•   æ³¨æ„ï¼šå¯¹äº**æ— å‚**æ„é€ å‡½æ•°ï¼Œ**ä¸éœ€è¦åŠ æ‹¬å·ï¼**
- æ˜¾å¼æ³•ï¼ˆå…ˆåˆ›å»º**åŒ¿åå¯¹è±¡**ï¼Œå†æŠŠå®ƒèµ‹å€¼ç»™ä¸€ä¸ª**æ–°**çš„**æœ‰å˜é‡å**çš„å¯¹è±¡ï¼‰
- éšå¼è½¬æ¢æ³•

#### ç¤ºä¾‹ï¼š

```c++
#include<iostream>
using namespace std;

class MyClass{
private:
    int age;
public:
    MyClass()
    {
        cout<<"æ— å‚æ„é€ å‡½æ•°"<<endl;
        age=0;
    }
    MyClass(int a)
    {
        cout<<"æœ‰å‚æ„é€ å‡½æ•°"<<endl;
        age=a;
    }
    MyClass(const MyClass& mc)
    {
        cout<<"æ‹·è´æ„é€ å‡½æ•°"<<endl;
        age=mc.age;
    }
    ~MyClass()
    {
        cout<<"ææ„å‡½æ•°"<<endl;
    }
};

void test1()
{
    //è°ƒç”¨æ–¹å¼
    //1.æ‹¬å·æ³•
    MyClass mc1;               //è°ƒç”¨æ— å‚æ„é€ å‡½æ•°
    MyClass mc2(100);          //è°ƒç”¨æœ‰å‚æ„é€ å‡½æ•°
    MyClass mc3(mc2);          //è°ƒç”¨æ‹·è´æ„é€ å‡½æ•°
}

void test2()
{
    //2.æ˜¾å¼æ³•
    MyClass mc1;               //è°ƒç”¨æ— å‚æ„é€ å‡½æ•°
    MyClass mc2=MyClass(100);  //è°ƒç”¨æœ‰å‚æ„é€ å‡½æ•°
    MyClass mc3=MyClass(mc2);  //è°ƒç”¨æ‹·è´æ„é€ å‡½æ•°

    MyClass(100);              //åŒ¿åå¯¹è±¡
}

void test3()
{
    //3.éšå¼è½¬æ¢æ³•
    MyClass mc1=100;           //è°ƒç”¨æœ‰å‚æ„é€ å‡½æ•°
    MyClass mc2=mc1;           //è°ƒç”¨æ‹·è´æ„é€ å‡½æ•°

}

int main()
{
    test1();
    test2();
    test3();
    return 0;
}
```

è¿è¡Œç»“æœï¼š

```c++
//test1
æ— å‚æ„é€ å‡½æ•°
æœ‰å‚æ„é€ å‡½æ•°
æ‹·è´æ„é€ å‡½æ•°
ææ„å‡½æ•°
ææ„å‡½æ•°
ææ„å‡½æ•°
    
//test2
æ— å‚æ„é€ å‡½æ•°
æœ‰å‚æ„é€ å‡½æ•°
æ‹·è´æ„é€ å‡½æ•°
æœ‰å‚æ„é€ å‡½æ•°
ææ„å‡½æ•°
ææ„å‡½æ•°
ææ„å‡½æ•°
ææ„å‡½æ•°
    
//test3    
æœ‰å‚æ„é€ å‡½æ•°
æ‹·è´æ„é€ å‡½æ•°
ææ„å‡½æ•°
ææ„å‡½æ•°
```



#### æ‹·è´æ„é€ å‡½æ•°çš„è°ƒç”¨æ—¶æœº

ä¸‹é¢ä»‹ç»æ‹·è´æ„é€ å‡½æ•°çš„è°ƒç”¨æ—¶æœºï¼Œå…±æœ‰**3ç§**ï¼š

##### 1.åˆå§‹åŒ–æ—¶ï¼šç”¨ä¸€ä¸ªå·²ç»åˆ›å»ºçš„å¯¹è±¡æ¥åˆå§‹åŒ–å¦ä¸€ä¸ªå¯¹è±¡

æœ¬è´¨ï¼šæŠŠ***å·²ç»åˆ›å»ºçš„å¯¹è±¡*** æ‹·è´åˆ° ***æ–°çš„å¯¹è±¡***

```c++
void test1()
{
    MyClass mc1(100);          
    MyClass mc2(mc1);          //è°ƒç”¨æ‹·è´æ„é€ å‡½æ•°
}
```

##### 2.å€¼ä¼ é€’ï¼šä»¥å€¼ä¼ é€’çš„æ–¹å¼ç»™å‡½æ•°å½¢å‚ä¼ å€¼

æœ¬è´¨ï¼šæŠŠ***å®å‚çš„å¯¹è±¡*** æ‹·è´åˆ° ***å½¢å‚çš„å¯¹è±¡***

```c++
void func(MyClass mc){
    cout<<"func(MyClass mc)"<<endl;
}
void test2()
{
    MyClass mc1=100;
    func(mc1);
}
```

##### 3.å‡½æ•°è¿”å›å€¼ï¼šå‡½æ•°è¿”å›å±€éƒ¨å˜é‡çš„å€¼

æœ¬è´¨ï¼šæŠŠ***å±€éƒ¨å˜é‡*** æ‹·è´åˆ° ***è¿”å›å€¼***

```c++
//å‡½æ•°è¿”å›å±€éƒ¨å˜é‡çš„å€¼
MyClass func2(){
    cout<<"func2(MyClass mc)"<<endl;
    MyClass mc=100;
    return mc;
}
void test5()
{
    MyClass mc=func2();     //è¿”å›æ—¶ä¼šè°ƒç”¨æ‹·è´æ„é€ å‡½æ•°
}
```



### 2. **ææ„å‡½æ•°ï¼ˆDestructorï¼‰**
#### **ä½œç”¨**ï¼š

ææ„å‡½æ•°æ˜¯åœ¨å¯¹è±¡**ç”Ÿå‘½å‘¨æœŸç»“æŸæ—¶**è‡ªåŠ¨è°ƒç”¨çš„å‡½æ•°ï¼Œä¸»è¦ç”¨äº***é‡Šæ”¾èµ„æº***ï¼Œä¾‹å¦‚é‡Šæ”¾å†…å­˜ã€å…³é—­æ–‡ä»¶å¥æŸ„ã€é”€æ¯å¯¹è±¡æŒæœ‰çš„å¤–éƒ¨èµ„æºç­‰ã€‚



#### ç‰¹ç‚¹ï¼š
- **åç§°**ï¼šææ„å‡½æ•°çš„åç§°ä¸**ç±»åç›¸åŒ**ï¼Œä½†å‰é¢æœ‰ä¸€ä¸ª**æ³¢æµªå·**ï¼ˆ`~`ï¼‰ã€‚
- **è¿”å›ç±»å‹**ï¼šææ„å‡½æ•°**æ²¡æœ‰è¿”å›ç±»å‹ï¼Œä¹Ÿä¸è¿”å›ä»»ä½•å€¼**ï¼Œä¹Ÿä¸å†™`void`ã€‚
- **è°ƒç”¨æ—¶æœº**ï¼šææ„å‡½æ•°**ä¸èƒ½è¢«æ˜¾å¼è°ƒç”¨**ï¼Œåªèƒ½åœ¨å¯¹è±¡**é”€æ¯æ—¶** **è‡ªåŠ¨**è°ƒç”¨ï¼ˆä¾‹å¦‚ï¼Œå±€éƒ¨å˜é‡è¶…å‡ºä½œç”¨åŸŸæ—¶ï¼Œæˆ–è€…é€šè¿‡ `delete` åˆ é™¤åŠ¨æ€åˆ†é…çš„å¯¹è±¡æ—¶ï¼‰ã€‚
- æ¯ä¸ªç±»**æœ€å¤šåªèƒ½æœ‰ä¸€ä¸ªææ„å‡½æ•°**ã€‚
- ææ„å‡½æ•°**æ²¡æœ‰å‚æ•°**ï¼Œå› æ­¤**ä¸èƒ½**å‘ç”Ÿ**é‡è½½**ã€‚



> [!CAUTION]
>
> ææ„å‡½æ•°å¯ä»¥æ˜¯ `private`
>
> ä¸€èˆ¬ç”¨äºï¼š
>
> 1. å•ä¾‹æ¨¡å¼ï¼šé˜²æ­¢å¤–éƒ¨ `delete`å¯¹è±¡
> 2. ç¦æ­¢å¯¹è±¡åœ¨æ ˆä¸Šåˆ›å»ºï¼Œä½†å…è®¸ç”¨ `new` æ¥åˆ›å»ºï¼Œå¹¶ç”±ç±»å†…éƒ¨ç®¡ç† `delete`



#### ç¤ºä¾‹ï¼š
```cpp
class MyClass {
public:
    int x;

    // æ„é€ å‡½æ•°
    MyClass(int value) : x(value) {
        std::cout << "æ„é€ å‡½æ•°è¢«è°ƒç”¨ï¼Œx = " << x << std::endl;
    }

    // ææ„å‡½æ•°
    ~MyClass() {
        std::cout << "ææ„å‡½æ•°è¢«è°ƒç”¨ï¼Œx = " << x << std::endl;
    }
};

int main() {
    MyClass obj(10);  // åˆ›å»ºå¯¹è±¡æ—¶è°ƒç”¨æ„é€ å‡½æ•°
}  // ç¨‹åºç»“æŸæ—¶ï¼Œobj è¶…å‡ºä½œç”¨åŸŸï¼Œè°ƒç”¨ææ„å‡½æ•°
```

è¾“å‡ºï¼š
```
æ„é€ å‡½æ•°è¢«è°ƒç”¨ï¼Œx = 10
ææ„å‡½æ•°è¢«è°ƒç”¨ï¼Œx = 10
```



#### ææ„çš„é¡ºåº

```cpp
#include <iostream>
using namespace std;

class A {
    string name;
public:
    A(string name) {
        this->name = name;
        cout << "A(" << name << ")" << endl;
    }
    ~A() {
        cout << "~A(" << name << ")" << endl;
    }
};

int main() {
    A a1("a1"), a2("a2");
    return 0;
}
```



```bash
A(a1)
A(a2)
~A(a2)
~A(a1)
```

ç”±äºå±€éƒ¨å˜é‡å­˜å‚¨åœ¨**æ ˆ** ï¼Œæ ¹æ®æ ˆ ***åè¿›å…ˆå‡º*** çš„ç‰¹ç‚¹ï¼š**åç”Ÿæˆçš„å˜é‡å…ˆé”€æ¯**



### 3. **æ„é€ å‡½æ•°ä¸ææ„å‡½æ•°çš„ä¸»è¦åŒºåˆ«**

| **ç‰¹æ€§**           | **æ„é€ å‡½æ•°**                               | **ææ„å‡½æ•°**                                               |
| ------------------ | ------------------------------------------ | ---------------------------------------------------------- |
| **è°ƒç”¨æ—¶æœº**ï¼ˆå¼‚ï¼‰ | å¯¹è±¡**åˆ›å»ºæ—¶**è‡ªåŠ¨è°ƒç”¨                     | å¯¹è±¡**é”€æ¯æ—¶**è‡ªåŠ¨è°ƒç”¨ï¼ˆå¦‚è¶…å‡ºä½œç”¨åŸŸæˆ–é€šè¿‡ `delete` åˆ é™¤ï¼‰ |
| **ä½œç”¨**ï¼ˆå¼‚ï¼‰     | åˆå§‹åŒ–å¯¹è±¡ï¼Œåˆ†é…èµ„æº                       | æ¸…ç†èµ„æºï¼Œé‡Šæ”¾å¯¹è±¡å ç”¨çš„å†…å­˜æˆ–å¤–éƒ¨èµ„æº                     |
| **è¿”å›ç±»å‹**ï¼ˆåŒï¼‰ | æ²¡æœ‰è¿”å›ç±»å‹                               | æ²¡æœ‰è¿”å›ç±»å‹                                               |
| **å‚æ•°**ï¼ˆå¼‚ï¼‰     | å¯ä»¥**æœ‰**å‚æ•°ï¼ˆæœ‰å‚æ„é€ å‡½æ•°ï¼‰ï¼Œä¹Ÿå¯ä»¥æ²¡æœ‰ | **æ²¡æœ‰**å‚æ•°                                               |
| **æ•°é‡**ï¼ˆå¼‚ï¼‰     | æ¯ä¸ªç±»å¯ä»¥æœ‰å¤šä¸ªæ„é€ å‡½æ•°ï¼ˆæ„é€ å‡½æ•°é‡è½½ï¼‰   | æ¯ä¸ªç±»æœ€å¤šåªæœ‰ä¸€ä¸ªææ„å‡½æ•°                                 |
| **è°ƒç”¨æ–¹å¼**ï¼ˆå¼‚ï¼‰ | æ„é€ å‡½æ•°ç”±ç¼–è¯‘å™¨åœ¨**å¯¹è±¡åˆ›å»ºæ—¶**è‡ªåŠ¨è°ƒç”¨   | ææ„å‡½æ•°ç”±ç¼–è¯‘å™¨åœ¨**å¯¹è±¡é”€æ¯æ—¶**è‡ªåŠ¨è°ƒç”¨                   |
| **æ˜¾å¼è°ƒç”¨**ï¼ˆå¼‚ï¼‰ | **å¯ä»¥æ˜¾å¼**è°ƒç”¨ï¼ˆé€šè¿‡åˆ›å»ºå¯¹è±¡ï¼‰           | **ä¸èƒ½**æ˜¾å¼è°ƒç”¨ï¼Œ**ç³»ç»Ÿè‡ªåŠ¨è°ƒç”¨**                         |

æ„é€ å‡½æ•°å’Œææ„å‡½æ•°éƒ½æ˜¯å¿…é¡»æœ‰çš„ï¼Œå¦‚æœç¨‹åºå‘˜æ²¡æœ‰æä¾›ï¼Œç¼–è¯‘å™¨ä¼šæä¾›ä¸€ä¸ª**ç©ºå®ç°**çš„æ„é€ å‡½æ•°å’Œææ„å‡½æ•°





### 4.ç¼–è¯‘å™¨åˆ›å»ºå‡½æ•°åŠŸèƒ½

#### 4.1ç¼–è¯‘å™¨è‡ªåŠ¨åˆ›å»ºå‡½æ•°åŠŸèƒ½

1. ä¸€æ—¦åˆ›å»ºä¸€ä¸ªç±»ï¼Œç¼–è¯‘å™¨å°±ä¼šè‡ªåŠ¨åˆ›å»ºè‡³å°‘3ä¸ªå‡½æ•°ï¼š

   - é»˜è®¤æ„é€ å‡½æ•°ï¼ˆç©ºå®ç°ï¼‰
   - æ‹·è´æ„é€ å‡½æ•°ï¼ˆå€¼æ‹·è´ï¼‰
   - ææ„å‡½æ•°ï¼ˆç©ºå®ç°ï¼‰

2. å¦‚æœæˆ‘ä»¬æä¾›äº†æœ‰å‚æ„é€ å‡½æ•°ï¼Œé‚£ä¹ˆç¼–è¯‘å™¨å°±**ä¸**è‡ªåŠ¨åˆ›å»º***é»˜è®¤æ„é€ å‡½æ•°***ï¼Œä½†æ˜¯ä»ä¼šè‡ªåŠ¨åˆ›å»º ***æ‹·è´æ„é€ å‡½æ•°***ã€***ææ„å‡½æ•°***

3. å¦‚æœæˆ‘ä»¬æä¾›äº†æ‹·è´æ„é€ å‡½æ•°ï¼Œé‚£ä¹ˆç¼–è¯‘å™¨å°±**ä¸**è‡ªåŠ¨åˆ›å»º***é»˜è®¤æ„é€ å‡½æ•°***å’Œ***æœ‰å‚æ„é€ å‡½æ•°***

   

> [!WARNING]
>
> é‰´äºç¼–è¯‘å™¨è‡ªåŠ¨åˆ›å»ºå‡½æ•°åŠŸèƒ½ï¼Œ
>
> åœ¨å†™ç±»æ—¶ï¼Œ
>
> 1. å¦‚æœæˆ‘ä»¬æä¾›äº†***æœ‰å‚æ„é€ å‡½æ•°***ï¼Œå°±ä¹Ÿè¦æä¾›***é»˜è®¤æ„é€ å‡½æ•°***
> 2. å¦‚æœæˆ‘ä»¬æä¾›äº†***æ‹·è´æ„é€ å‡½æ•°***ï¼Œå°±ä¹Ÿè¦æä¾›***é»˜è®¤æ„é€ å‡½æ•°***å’Œ***æœ‰å‚æ„é€ å‡½æ•°***ï¼Œ



#### 4.2äººä¸ºæŒ‡å®šç¼–è¯‘å™¨åˆ›å»ºå‡½æ•°

##### **`=default`**

ä½œç”¨ï¼šä»¤ç¼–è¯‘å™¨ä¸ºæŸä¸ªç±»ç”Ÿæˆ**ç‰¹æ®Šæˆå‘˜å‡½æ•°**æˆ–æ¯”è¾ƒè¿ç®—ç¬¦çš„æ˜¾å¼æŒ‡ä»¤

ä»…ä»…ç”¨äºç¼–è¯‘å™¨**èƒ½è‡ªåŠ¨ç”Ÿæˆ**çš„ç‰¹æ®Šæˆå‘˜å‡½æ•°  

> ç‰¹æ®Šæˆå‘˜å‡½æ•°
>
> åŒ…æ‹¬ï¼š
>
> - é»˜è®¤æ„é€ å‡½æ•°:T()
> - ææ„å‡½æ•°:~T()
> - æ‹·è´æ„é€ å‡½æ•°:T(const T&)
> - èµ‹å€¼è¿ç®—:operator=(const T&) 

è¯­æ³•ï¼š

`=default` å¿…é¡»åœ¨å‡½æ•°å£°æ˜åï¼Œè®©ç¼–è¯‘åˆ›å»ºè¯¥æ„é€ å‡½æ•°

ä½¿ç”¨åè¯¥å‡½æ•°ä¸èƒ½å†è‡ªå®šä¹‰å®ç°  



##### `=delete   `

ä½œç”¨ï¼šæŠŠå‡½æ•°å®šä¹‰ä¸ºå¼ƒç½®çš„ï¼ˆdeletedï¼‰  

ä»»ä½•å¼ƒç½®å‡½æ•°çš„ä½¿ç”¨éƒ½æ˜¯éè‰¯æ„çš„ï¼ˆç¨‹åºæ— æ³•ç¼–è¯‘ï¼‰   

è¯­æ³•ï¼š

åˆ é™¤çš„å‡½æ•°å®šä¹‰å¿…é¡»æ˜¯å‡½æ•°çš„**é¦–æ¬¡å£°æ˜**  



### 5.ç±»å¯¹è±¡ä½œä¸ºæˆå‘˜å˜é‡

ä¾‹å¦‚ï¼šç±»Aæ˜¯ç±»Bçš„æˆå‘˜å˜é‡

é‚£ä¹ˆåˆ›å»ºç±»Bçš„å¯¹è±¡æ—¶ï¼Œå…ˆè°ƒç”¨ç±»Açš„æ„é€ å‡½æ•°-->åˆ›å»ºå‡ºä¸€ä¸ªç±»Açš„å¯¹è±¡-->å†è°ƒç”¨ç±»Bçš„æ„é€ å‡½æ•°

è€Œåœ¨åˆ é™¤ç±»Bçš„å¯¹è±¡æ—¶ï¼Œ**å…ˆ**è°ƒç”¨ç±»**Bçš„ææ„å‡½æ•°**-->**å†**è°ƒç”¨ç±»**Açš„ææ„å‡½æ•°**



## æµ…æ‹·è´ä¸æ·±æ‹·è´

### 1.æµ…æ‹·è´ï¼š

**æµ…å¤åˆ¶ç­–ç•¥**åªæŒ‰ç”³æ˜é¡ºåºå¤åˆ¶æˆå‘˜çš„**å€¼**ï¼Œ**ä¸**å¤åˆ¶**æŒ‡é’ˆæŒ‡å‘çš„å¯¹è±¡å®ä½“**  

ä¸¤ä¸ªå¯¹è±¡æ‰€æŒ‡å‘çš„å †åŒºåœ°å€**ç›¸åŒ**ï¼Œå› æ­¤åœ¨ææ„æ—¶**ä¼š** **é‡å¤é‡Šæ”¾**è¿™ä¸ªå †åŒºåœ°å€çš„å†…å­˜ï¼Œé€ æˆ**æŠ¥é”™ï¼**



![image-20250209082254336](C++%E7%B1%BB%E7%9A%84%E7%AE%80%E4%BB%8B.assets/image-20250209082254336-1739060589373-1.png)

è§£å†³æ–¹æ³•ï¼šä½¿ç”¨æ·±æ‹·è´



### 2.æ·±æ‹·è´ï¼š

ä¸¤ä¸ªå¯¹è±¡æ‰€æŒ‡å‘çš„å †åŒºåœ°å€ä¸åŒï¼Œå› æ­¤åœ¨ææ„æ—¶**ä¸ä¼š**åƒæµ…æ‹·è´é‚£æ · é‡å¤é‡Šæ”¾å †åŒºçš„å†…å­˜

![image-20250209082417627](C++%E7%B1%BB%E7%9A%84%E7%AE%80%E4%BB%8B.assets/image-20250209082417627-1739060660699-3.png)



#### å…·ä½“ä»£ç 

```c++
class MyClass{
public:
    int age;
    int *pt;

    MyClass(const MyClass& mc){
        age=mc.age;
        pt=mc.pt;//æµ…æ‹·è´
    }
}
```

```c++
class MyClass{
public:
    int age;
    int *pt;
	
    //æ·±æ‹·è´æ„é€ å‡½æ•°
    MyClass(const MyClass& mc){
        age=mc.age;
        pt=new int(*mc.pt);//æ·±æ‹·è´
    }
}
```



#### æ·±æ‹·è´çš„å®ç°ï¼šğŸŒŸ

æ·±æ‹·è´ä¸ä»…èƒ½åœ¨**æ„é€ å‡½æ•°**ä¸­å®ç°ï¼Œè¿˜å¯ä»¥åœ¨**é‡è½½èµ‹å€¼è¿ç®—ç¬¦`=`**ä¸­å®ç°

ä½†æ˜¯è¦æ³¨æ„äºŒè€…çš„ä½¿ç”¨æ–¹å¼ä¸åŒï¼

```cpp
#include<iostream>
#include <cstring>
#include <string>
using namespace std;
class String{
private:
Â  Â  char* data;
Â  Â  int length;
public:
Â  Â  String(const char* s){
Â  Â  Â  Â  int i;
Â  Â  Â  Â  for(i=0;s[i]!='\0';i++);
Â  Â  Â  Â  length=i;
Â  Â  Â  Â  data=new char[length];
Â  Â  Â  Â  for(i=0;s[i]!='\0';i++)
Â  Â  Â  Â  {
Â  Â  Â  Â  Â  Â  data[i]=s[i];
Â  Â  Â  Â  }
Â  Â  }
Â  Â  String() =default;
	
    //æ·±æ‹·è´æ„é€ å‡½æ•°ğŸŒŸ
Â  Â  String(const String& s2){
Â  Â  Â  Â  length=s2.length;
Â  Â  Â  Â  data=new char[length];
Â  Â  Â  Â  memcpy(data,s2.data,sizeof(char)*length);
Â  Â  }
	
    //æ·±æ‹·è´èµ‹å€¼ğŸŒŸ
Â  Â  String& operator=(const String& s2)
Â  Â  {
Â  Â  Â  Â  if (this!=&s2)
Â  Â  Â  Â  {
Â  Â  Â  Â  Â  Â  delete[] data;
Â  Â  Â  Â  Â  Â  length=s2.length;
Â  Â  Â  Â  Â  Â  data=new char[length];
Â  Â  Â  Â  Â  Â  memcpy(data,s2.data,sizeof(char)*length);
Â  Â  Â  Â  }
Â  Â  Â  Â  return *this;
Â  Â  }

Â  Â  ~String(){
Â  Â  Â  Â  delete[] data;
Â  Â  }

Â  Â  void print() const
Â  Â  {
Â  Â  Â  Â  for(int i=0;i<length;i++)
Â  Â  Â  Â  {
Â  Â  Â  Â  Â  Â  cout<<data[i];
Â  Â  Â  Â  }
Â  Â  }

};
int main()
{
Â  Â  char char_string[100]={'\0'};
Â  Â  cin.getline(char_string,100); //æœ€å¤šè¯»å–100ä¸ªå­—ç¬¦
    
Â  Â  String s1(char_string);
    
    //ä½¿ç”¨æ–¹å¼
Â  Â  String s2;
Â  Â  s2=s1;			//è°ƒç”¨æ·±æ‹·è´èµ‹å€¼
    
Â  Â  String s3=s1;   //è°ƒç”¨æ·±æ‹·è´æ„é€ å‡½æ•°
    
Â  Â  cout<<"s1: ";
Â  Â  s1.print();
Â  Â  cout<<endl;

Â  Â  cout<<"s2: ";
Â  Â  s2.print();
Â  Â  cout<<endl;
    
	cout<<"s3: ";
Â  Â  s3.print();
Â  Â  cout<<endl;
    
Â  Â  return 0;
}
```



#### æ³¨æ„äº‹é¡¹ï¼š

1.è¦åœ¨**ææ„å‡½æ•°**ä¸­æŠŠå †åŒºçš„å†…å­˜é‡Šæ”¾å¹²å‡€

ç¤ºä¾‹ä»£ç 

```c++
~MyClass()
{
	if(pt!=NULL)
	{
		delete pt;
		pt=NULL;
	}
}
```



2.**æ‹·è´æ„é€ å‡½æ•°**ä¸­çš„å‚æ•°æŒ‰**å¼•ç”¨**æ–¹å¼ä¼ é€’

åŸå› ï¼šå¦‚æœä¸æ˜¯å¼•ç”¨çš„æ–¹å¼ï¼Œè€Œæ˜¯**å€¼**ä¼ é€’ã€‚ç”±äºä¼ å€¼çš„æ–¹å¼ä¼šè°ƒç”¨è¯¥ç±»çš„æ‹·è´æ„é€ å‡½æ•°ï¼Œé‚£ä¹ˆå‚æ•°è¿›è¡Œå€¼ä¼ é€’æ—¶ä¼šæ— ç©·åœ°è°ƒç”¨æ‹·è´æ„é€ å‡½æ•°ã€‚å› æ­¤æ‹·è´æ„é€ å‡½æ•°çš„å‚æ•°å¿…é¡»æ˜¯ä¸€ä¸ªå¼•ç”¨ã€‚



3.**æ‹·è´æ„é€ å‡½æ•°**åªæœ‰**1ä¸ª**

åŸå› ï¼šæ‹·è´æ„é€ å‡½æ•°çš„å‚æ•°åªæœ‰1ä¸ªï¼Œé‚£å°±æ˜¯è¢«æ‹·è´çš„å¯¹è±¡ï¼Œæ‰€ä»¥æ— æ³•è¿›è¡Œé‡è½½ã€‚



## é™æ€æˆå‘˜

### é™æ€æˆå‘˜å˜é‡

#### ç‰¹ç‚¹ï¼š

1. æ‰€æœ‰å¯¹è±¡å…±ç”¨ä¸€ä»½æ•°æ®ï¼Œå¹¶ä¸å•ç‹¬å±äºæŸä¸ªå¯¹è±¡
2. åœ¨ç¼–è¯‘é˜¶æ®µåˆ†é…å†…å­˜ï¼Œåˆ†é…åœ¨å…¨å±€åŒº
3. ç±»å†…å£°æ˜ï¼Œ**ç±»å¤–åˆå§‹åŒ–**

> [!CAUTION]
>
> é™æ€æˆå‘˜å˜é‡**ç±»å¤–åˆå§‹åŒ–**æ—¶ï¼Œ**ä¸ç”¨**å†å†™ `static`
>
> åªæœ‰åœ¨**ç±»å†…å£°æ˜**æ—¶ï¼Œæ‰å†™ `static`

> [!WARNING]
>
> é™æ€æˆå‘˜å˜é‡ **ä¸èƒ½** åœ¨ **æ„é€ å‡½æ•°** ä¸­åˆå§‹åŒ–ï¼Œå› ä¸ºå®ƒæ˜¯ **æ‰€æœ‰å¯¹è±¡å…±äº«** çš„ï¼Œä¸èƒ½ä¸ºæ¯ä¸ªå¯¹è±¡å•ç‹¬åˆå§‹åŒ–ã€‚



#### è®¿é—®æ–¹å¼ï¼šï¼ˆ2ç§ï¼‰

##### 1.é€šè¿‡**å¯¹è±¡**æ¥è®¿é—®

è¯­æ³•ï¼š`å¯¹è±¡å.é™æ€æˆå‘˜å˜é‡å`

ä¾‹å¦‚ï¼š`p1.s_a`

##### 2.é€šè¿‡**ç±»å**æ¥è®¿é—®

è¯­æ³•ï¼š`ç±»å::é™æ€æˆå‘˜å˜é‡å`

ä¾‹å¦‚ï¼š`Person::s_a`

æœ‰è¿™ç§è¯­æ³•çš„åŸå› ï¼šå› ä¸ºé™æ€æˆå‘˜å˜é‡æ˜¯è¯¥ç±»ä¸­æ‰€æœ‰å¯¹è±¡**å…¬å…±**çš„



#### ç¤ºä¾‹ä»£ç ï¼š

```c++
#include<iostream>
using namespace std;

class Person{
public:
    int a;//éé™æ€æˆå‘˜å˜é‡
    static int s_a;//é™æ€æˆå‘˜å˜é‡
};

int Person::s_a=100;//é™æ€æˆå‘˜å˜é‡ è¦ ç±»å¤–åˆå§‹åŒ–

void test1()
{
    Person p1;
    p1.a=1;
    cout<<"p1.a="<<p1.a<<"  åœ°å€:"<<&(p1.a)<<endl;
    cout<<"p1.s_a="<<p1.s_a<<"  åœ°å€:"<<&(p1.s_a)<<endl;

    Person p2;
    p2.a=2;
    p2.s_a=111;
    cout<<"p1.a="<<p1.a<<"  åœ°å€:"<<&(p1.a)<<endl;
    cout<<"p2.a="<<p2.a<<"  åœ°å€:"<<&(p2.a)<<endl;
    
    cout<<"p1.s_a="<<p1.s_a<<"  åœ°å€:"<<&(p1.s_a)<<endl;
    cout<<"p2.s_a="<<p2.s_a<<"  åœ°å€:"<<&(p2.s_a)<<endl;
    cout<<"Person::s_a="<<Person::s_a<<"  åœ°å€:"<<&(Person::s_a)<<endl;
}
}

int main()
{
    test1();
    return 0;
}
```

è¿è¡Œç»“æœï¼š

```cmd
p1.a=1  åœ°å€:0x62fe1c
p1.s_a=100  åœ°å€:0x403010
p1.a=1  åœ°å€:0x62fe1c
p2.a=2  åœ°å€:0x62fe18
p1.s_a=111  åœ°å€:0x403010
p2.s_a=111  åœ°å€:0x403010
Person::s_a=111  åœ°å€:0x403010
```

ç”±æ­¤å¯è§ï¼Œ

- å¯¹è±¡`p1`,`p2`çš„æˆå‘˜å˜é‡`a`åˆ†é…åœ¨ä¸åŒçš„å†…å­˜å•å…ƒã€‚è€Œï¼Œå¯¹è±¡`p1`,`p2`çš„é™æ€æˆå‘˜å˜é‡`s_a`æ˜¯åŒä¸€ä¸ªæ•°æ®
- æˆå‘˜å˜é‡`a`åœ¨ä¸åŒå¯¹è±¡ä¹‹é—´ä¸èƒ½äº’ç›¸è®¿é—®ï¼Œä½†æ˜¯é™æ€æˆå‘˜å˜é‡`s_a`å¯ä»¥è¢«**è¿™ä¸ªç±»çš„æ‰€æœ‰å¯¹è±¡**å…±åŒè®¿é—®



> [!CAUTION]
>
> é™æ€æˆå‘˜å˜é‡çš„**ä½œç”¨åŸŸ**
>
> **ä¸æ˜¯**â€œä»…é™äºå®šä¹‰å®ƒçš„æ–‡ä»¶â€ï¼Œè€Œæ˜¯**æ•´ä¸ªç¨‹åº**
>
> ```cpp
> class Test {
> public:
>     static int x;  // å˜é‡å£°æ˜
> };
> 
> int Test::x = 10;  // å˜é‡å®šä¹‰ï¼ˆå¯ä»¥åœ¨å…¶ä»–æ–‡ä»¶è®¿é—®ï¼‰
> ```



### é™æ€æˆå‘˜å‡½æ•°

#### ç‰¹ç‚¹ï¼š

1. æ‰€æœ‰å¯¹è±¡**å…±äº«**åŒä¸€ä¸ªå‡½æ•°
2. é™æ€æˆå‘˜å‡½æ•°**åª**èƒ½è®¿é—®**é™æ€æˆå‘˜å˜é‡**

> [!CAUTION]
>
> ä¸ é™æ€æˆå‘˜å˜é‡ ç±»ä¼¼
>
> é™æ€æˆå‘˜å‡½æ•°**ç±»å¤–å®šä¹‰**æ—¶ï¼Œ**ä¸ç”¨**å†å†™ `static`ã€‚åªæœ‰åœ¨**ç±»å†…å£°æ˜**æ—¶ï¼Œæ‰å†™ `static`
>
> æˆ–è€… åœ¨**ç±»å†…å®šä¹‰**é™æ€æˆå‘˜å‡½æ•°ï¼Œè¦å†™`static`ã€‚
>
> 
>
> æ€»ä¹‹ï¼Œ**ç±»å†…è¦å†™`static`ï¼Œç±»å¤–ä¸ç”¨å†™**

#### è®¿é—®æ–¹å¼ï¼šï¼ˆ2ç§ï¼‰

##### 1.é€šè¿‡**å¯¹è±¡**æ¥è®¿é—®

è¯­æ³•ï¼š`å¯¹è±¡å.é™æ€æˆå‘˜å‡½æ•°å`

ä¾‹å¦‚ï¼š`p1.func`

##### 2.é€šè¿‡**ç±»å**æ¥è®¿é—®

è¯­æ³•ï¼š`ç±»å::é™æ€æˆå‘˜å‡½æ•°å`

ä¾‹å¦‚ï¼š`Person::func`

æœ‰è¿™ç§è¯­æ³•çš„åŸå› ï¼šå› ä¸ºé™æ€æˆå‘˜å‡½æ•°æ˜¯è¯¥ç±»ä¸­æ‰€æœ‰å¯¹è±¡**å…±äº«**çš„



#### ç¤ºä¾‹ä»£ç ï¼š

```c++
static void func()
{
    s_a=1;//é™æ€æˆå‘˜å‡½æ•° å¯ä»¥è®¿é—®é™æ€æˆå‘˜å˜é‡
    //a=1;//é™æ€æˆå‘˜å‡½æ•° ä¸å¯ä»¥è®¿é—®éé™æ€æˆå‘˜å˜é‡ æŠ¥é”™ï¼
    cout<<"è°ƒç”¨ static void func()"<<endl;
}
```



> [!IMPORTANT]
>
> é™æ€æˆå‘˜å‡½æ•° åªå¯ä»¥è®¿é—®é™æ€æˆå‘˜å˜é‡ï¼Œ**ä¸å¯ä»¥**è®¿é—®**éé™æ€æˆå‘˜å˜é‡**
>
> ä½†æ˜¯!
>
> **éé™æ€æˆå‘˜å‡½æ•°** æ—¢å¯ä»¥è®¿é—®**é™æ€æˆå‘˜å˜é‡**ï¼Œåˆå¯ä»¥è®¿é—®**éé™æ€æˆå‘˜å˜é‡**
>
> 
>
> **åŸå› è§£é‡Šï¼š**
>
> é™æ€æˆå‘˜å‡½æ•°æ˜¯æ‰€æœ‰å¯¹è±¡å…¬å…±çš„ã€‚å¦‚æœå®ƒè¦è®¿é—®éé™æ€æˆå‘˜å˜é‡ï¼Œé‚£ä¹ˆå°±ç¼–è¯‘å™¨ä¸çŸ¥é“ å…·ä½“æ˜¯è¦è®¿é—®å“ªä¸ªå¯¹è±¡çš„éé™æ€æˆå‘˜å˜é‡
>
> éé™æ€æˆå‘˜å‡½æ•°æ˜¯æ¯ä¸ªå¯¹è±¡ç§æœ‰çš„ã€‚è®¿é—®éé™æ€æˆå‘˜å˜é‡æ—¶ï¼Œå¯ä»¥æ˜ç¡®çŸ¥é“è¦è®¿é—®å“ªä¸ªå¯¹è±¡çš„éé™æ€æˆå‘˜å˜é‡ï¼›å½“ç„¶ä¹Ÿå¯ä»¥è®¿é—®é™æ€æˆå‘˜å˜é‡ï¼Œå› ä¸ºé™æ€æˆå‘˜å˜é‡æ˜¯å…¬å…±çš„ï¼Œæ˜¯è°è®¿é—®éƒ½å¯ä»¥ã€‚





## æˆå‘˜å˜é‡ä¸æˆå‘˜å‡½æ•°çš„å­˜å‚¨

å†…å­˜ç©ºé—´çš„è®¡ç®—ï¼š

- **åªç®—éé™æ€æˆå‘˜å˜é‡ï¼Œ**
- ä¸ç®—é™æ€æˆå‘˜å˜é‡ï¼›

- ä¸ç®—éé™æ€æˆå‘˜å‡½æ•°ï¼Œ

- ä¹Ÿä¸ç®—é™æ€æˆå‘˜å‡½æ•°




è®¡ç®—æ–¹å¼ï¼š

- **åªç®—éé™æ€æˆå‘˜å˜é‡ï¼Œ**è¿˜è¦è€ƒè™‘**å¯¹é½æ–¹å¼**ï¼Œä¸ç»“æ„ä½“å ç”¨å†…å­˜çš„è®¡ç®—æ–¹æ³•ä¸€è‡´




### ç©ºå¯¹è±¡

> [!WARNING]
>
> ä»€ä¹ˆæ˜¯ç©ºå¯¹è±¡ï¼Ÿ
>
> æ²¡æœ‰**éé™æ€æˆå‘˜å˜é‡**çš„ç±»æ‰€åˆ›å»ºçš„å¯¹è±¡

å†…å­˜ç©ºé—´ï¼š1ä¸ªå­—èŠ‚

C++ç¼–è¯‘å™¨ä¼šç»™æ¯ä¸ªç©ºå¯¹è±¡åˆ†é… 1ä¸ªå­—èŠ‚çš„å†…å­˜ç©ºé—´ï¼Œç›®çš„æ˜¯åŒºåˆ†ç©ºå¯¹è±¡æ‰€å çš„å†…å­˜çš„ä½ç½®ã€‚

æ¯ä¸ªç©ºå¯¹è±¡ä¹Ÿæœ‰1ä¸ªç‹¬ä¸€æ— äºŒçš„å†…å­˜åœ°å€ã€‚



ç¤ºä¾‹ä»£ç 

```c++
class Person1{

};

int main()
{
    //ç©ºå¯¹è±¡
    Person1 p1;
    cout<<"sizeof(p1)="<<sizeof(p1)<<endl;
    return 0;
}
```

```cmd
sizeof(p1)=1
```



### éç©ºå¯¹è±¡

> [!WARNING]
>
> ä»€ä¹ˆæ˜¯ç©ºå¯¹è±¡ï¼Ÿ
>
> æœ‰**éé™æ€æˆå‘˜å˜é‡**çš„ç±»æ‰€åˆ›å»ºçš„å¯¹è±¡

ç¤ºä¾‹ä»£ç 

```c++
class Person2{
    int a;//éé™æ€æˆå‘˜å˜é‡
    static int s_a;//é™æ€æˆå‘˜å˜é‡
    void func()//éé™æ€æˆå‘˜å‡½æ•°
    {
        
    }
    static void func2()//éé™æ€æˆå‘˜å‡½æ•°
    {
        
    }
};

int main()
{
    //éç©ºå¯¹è±¡
    Person2 p2;
    cout<<"sizeof(p2)="<<sizeof(p2)<<endl;
    return 0;
}
```

```cmd
sizeof(p2)=4
```



æ‰€ä»¥ï¼Œæ¯ä¸€ä¸ªéé™æ€æˆå‘˜å‡½æ•°åªä¼šäº§ç”Ÿ**1ä»½å‡½æ•°å®ä¾‹**ï¼Œå³ï¼šåŒä¸€ä¸ªç±»ä¸‹çš„**æ‰€æœ‰å¯¹è±¡çš„éé™æ€æˆå‘˜å‡½æ•°**æ˜¯å ç”¨**åŒä¸€å—å†…å­˜**çš„



## thisæŒ‡é’ˆ

>ç”±å‰æ–‡â€œæˆå‘˜å˜é‡ä¸æˆå‘˜å‡½æ•°çš„å­˜å‚¨â€ä¸­å¾—çŸ¥ï¼Œâ€œåŒä¸€ä¸ªç±»ä¸‹çš„**æ‰€æœ‰å¯¹è±¡çš„éé™æ€æˆå‘˜å‡½æ•°**æ˜¯å ç”¨**åŒä¸€å—å†…å­˜**çš„â€
>
>é‚£ä¹ˆï¼Œè¿™ä¸€å—ä»£ç æ˜¯å¦‚ä½•åŒºåˆ†æ˜¯å“ªä¸€ä¸ªå¯¹è±¡è°ƒç”¨è‡ªå·±å‘¢ï¼Ÿ
>
>
>
>å›ç­”ï¼š
>
>åˆ©ç”¨**thisæŒ‡é’ˆ**
>
>**thisæŒ‡é’ˆ**æŒ‡å‘è°ƒç”¨éé™æ€æˆå‘˜å‡½æ•°çš„**å¯¹è±¡**
>
>**thisæŒ‡é’ˆ**éšå«åœ¨æ¯ä¸€ä¸ªéé™æ€æˆå‘˜å‡½æ•°å†…ï¼Œä¸éœ€è¦å®šä¹‰ï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨
>
>ï¼ˆåº•å±‚åŸå› ï¼šç¼–è¯‘å™¨è‡ªåŠ¨é»˜è®¤å‘éé™æ€æˆå‘˜å‡½æ•°ä¼ äº†ä¸€ä¸ªå½¢å‚`ç±»å *this`ï¼‰



### thisæŒ‡é’ˆçš„æœ¬è´¨ï¼šæŒ‡é’ˆå¸¸é‡

> [!IMPORTANT]
>
> thisæŒ‡é’ˆçš„æœ¬è´¨ï¼šæŒ‡é’ˆå¸¸é‡
>
> å³ï¼š`ç±»å *const this` 
>
> æ‰€ä»¥ï¼šthisæŒ‡é’ˆ æœ¬èº«çš„å€¼ä¸èƒ½ä¿®æ”¹ï¼ˆä¹Ÿå°±æ˜¯ä¸èƒ½ä¿®æ”¹thisæŒ‡é’ˆ**æŒ‡å‘è°**ï¼‰ï¼Œ`this=NULL;//é”™`
>
> ä½†æ˜¯èƒ½ä¿®æ”¹ thisæŒ‡é’ˆ æ‰€æŒ‡å‘å˜é‡çš„å€¼ï¼ˆä¹Ÿå°±æ˜¯èƒ½ä¿®æ”¹thisæŒ‡é’ˆ**æŒ‡å‘å¯¹è±¡çš„å±æ€§**ï¼‰`this->age=a;//å¯¹`



### è¯­æ³•ï¼š

ä¾‹å¦‚ï¼š

```c++
class Person{
    int age;
    void setAge(int a)
    {
        this->age=a;//ç­‰ä»·äºage=a;
    }
};

```



### ä½œç”¨ï¼š

- å½“æˆå‘˜å˜é‡ä¸å½¢å‚**åŒå**æ—¶ï¼Œç”¨**thisæŒ‡é’ˆ**æ¥åŒºåˆ†

ä¾‹å¦‚ï¼šä¸‹é¢çš„`isSameAge`å‡½æ•°

```c++
class Person{
    int age;

    bool isSameAge(int age)
    {
        if( this->age==age)//å½“æˆå‘˜å˜é‡ä¸å½¢å‚åŒåæ—¶ï¼Œç”¨**thisæŒ‡é’ˆ**æ¥åŒºåˆ†
        {
            return true;
        }
        else
        {
            return false;
        }
    }
};
```



- éé™æ€æˆå‘˜å‡½æ•°ä¸­**è¿”å›å¯¹è±¡æœ¬èº«**ï¼Œç”¨`return *this`ï¼Œè€Œä¸”å‡½æ•°ç±»å‹ä¸º `ç±»å&`

```c++
class Person{
public:
    int age;

    Person (int a): age(a){}

    //éé™æ€æˆå‘˜å‡½æ•°
    Person& addAge(Person &p)
    {
        this->age+=p.age;
        return *this;//è¿”å›å€¼ä¸ºå¯¹è±¡æœ¬èº«
    }
};

int main()
{
    Person p1(10),p2(1);

    p2.addAge(p1).addAge(p1).addAge(p1);

    cout<<p2.age<<endl;
    return 0;
}
```

è¿è¡Œç»“æœï¼š

```cmd
31
```

è§£é‡Šï¼š

`p2.addAge(p1).addAge(p1).addAge(p1);`æ¯ä¸€æ¬¡è°ƒç”¨`addAge(p1)`ï¼Œè¿”å›çš„éƒ½æ˜¯p2æœ¬èº«ï¼Œ

ç„¶å åä¸€æ¬¡è°ƒç”¨`addAge(p1)`ï¼Œåˆä½œç”¨äºp2æœ¬èº«ï¼Œ

æ‰€ä»¥æœ€ç»ˆ `p2.age=p2.age+p1.age+p1.age+p1.age=31`



å¦‚æœæŠŠå‡½æ•°ç±»å‹ ä»  `ç±»å&` æ”¹ä¸º  `ç±»å`

å³ï¼šä»  `Person& addAge(Person &p)` æ”¹ä¸º`Person addAge(Person &p)` ï¼Œ

è§ä¸‹æ–¹ä»£ç ï¼š

```c++
class Person{
public:
    int age;

    Person (int a): age(a){}

    Person addAge(Person &p)
    {
        this->age+=p.age;
        return *this;//è¿”å›å€¼ä¸ºå¯¹è±¡çš„ä¸€ä¸ªæ‹·è´
    }
};

int main()
{
    Person p1(10),p2(1);

    p2.addAge(p1).addAge(p1).addAge(p1);

    cout<<p2.age<<endl;
    return 0;
}
```

è¿è¡Œç»“æœï¼š

```cmd
11
```

è§£é‡Šï¼š

`p2.addAge(p1).addAge(p1).addAge(p1);`

ç¬¬1æ¬¡è°ƒç”¨`addAge(p1)`ï¼Œ`p2.age`å˜æˆ11ï¼Œè¿”å›`p2`çš„æ‹·è´`p2'`

ç¬¬2æ¬¡è°ƒç”¨`addAge(p1)`ï¼Œæœ¬è´¨æ˜¯`p2'`è°ƒç”¨`addAge(p1)`ï¼Œ`p2'.age`å˜æˆ21ï¼Œè¿”å›`p2'`çš„æ‹·è´`p2''`

ç¬¬3æ¬¡è°ƒç”¨`addAge(p1)`ï¼Œæœ¬è´¨æ˜¯ `p2''`è°ƒç”¨`addAge(p1)`ï¼Œ`p2''.age`å˜æˆ31ï¼Œè¿”å›`p2''`çš„æ‹·è´`p2'''`

æ‰€ä»¥ï¼Œå®é™…ä¸Š`p2.age`åªåœ¨ç¬¬1æ¬¡è°ƒç”¨`addAge(p1)`æ—¶è¢«ä¿®æ”¹æˆ11





## ç©ºå¯¹è±¡æŒ‡é’ˆè®¿é—®æˆå‘˜å‡½æ•°

> åœ¨å®é™…ä½¿ç”¨ä¸­ï¼Œç»å¸¸ä½¿ç”¨**å¯¹è±¡æŒ‡é’ˆ**æ¥å¯¹ å¯¹è±¡ è¿›è¡Œæ“ä½œï¼Œè¿™æ ·å¯ä»¥**é¿å…å¯¹è±¡çš„å¤šæ¬¡æ‹·è´ï¼Œå‡å°‘å†…å­˜å ç”¨**
>
> è¿™æ—¶ï¼Œè¦å°å¿ƒ***ç©ºå¯¹è±¡æŒ‡é’ˆ***



ç¤ºä¾‹ä»£ç ï¼š

```c++
class Person{
public:
    int age;

    void func1()
    {
        cout<<"void func1() is called"<<endl;
    }
    void func2()
    {
        cout<<"void func2() is called"<<endl;
        cout<<"age="<<this->age<<endl;//æˆ–è€…æŠŠâ€˜this->ageâ€™æ¢æˆâ€˜ageâ€™ï¼Œæ•ˆæœä¹Ÿä¸€æ ·
    }
};

int main()
{
    Person *p=NULL;//ç©ºæŒ‡é’ˆ
    p->func1();//ä¸æŠ¥é”™
    p->func2();//æŠ¥é”™
    return 0;
}
```

è§£é‡Šï¼š

1.`p->func1();`ä¸éœ€è¦ç”¨åˆ°**å¯¹è±¡æœ¬èº«**ï¼Œå› æ­¤ä¹Ÿä¸éœ€è¦ç”¨åˆ°**thisæŒ‡é’ˆ**ï¼Œæ‰€ä»¥ï¼šè™½ç„¶pæ˜¯**ç©ºæŒ‡é’ˆ**ï¼Œä¹Ÿ***ä¸æŠ¥é”™***

2.`p->func2();`éœ€è¦ç”¨åˆ°**å¯¹è±¡æœ¬èº«**ï¼Œå› æ­¤ä¹Ÿéœ€è¦ç”¨åˆ°**thisæŒ‡é’ˆ**ï¼Œæ‰€ä»¥ï¼šç”±äºpæ˜¯**ç©ºæŒ‡é’ˆ**ï¼Œ`this->age`æ²¡æœ‰ç›¸åº”çš„å€¼ï¼Œæ‰€ä»¥***æŠ¥é”™***



### è§£å†³æ–¹æ³•ï¼š

æŠŠ`func2()`æ”¹ä¸ºä»¥ä¸‹å½¢å¼ï¼Œèƒ½å¤Ÿæé«˜ä»£ç çš„å¥å£®æ€§

```c++
    void func2()
    {
        //å¦‚æœthisä¸ºç©ºæŒ‡é’ˆï¼Œåˆ™ç›´æ¥é€€å‡ºï¼Œä»è€Œä¸ä¼šæŠ¥é”™
        if(this==NULL)
        {
            return;
        }
        
        cout<<"void func2() is called"<<endl;
        cout<<"age="<<this->age<<endl;
    }
```





## `const`ä¸ç±»

### å¸¸å˜é‡ï¼ˆç”¨`const`ä¿®é¥°çš„æˆå‘˜å˜é‡ï¼‰

å¸¸éé™æ€æˆå‘˜ å¿…é¡»ç”±**é»˜è®¤åˆå§‹åŒ–å™¨**æˆ–**åˆå§‹åŒ–å™¨åˆ—è¡¨**åˆå§‹åŒ–  



### å¸¸å‡½æ•°ï¼ˆç”¨`const`ä¿®é¥°çš„æˆå‘˜å‡½æ•°ï¼‰

#### Whatï¼š

æˆå‘˜å‡½æ•°+`const`=>**å¸¸å‡½æ•°**

#### ä½œç”¨ï¼š

å¸¸å‡½æ•°å†…**ä¸å¯ä»¥**ä¿®æ”¹æˆå‘˜å±æ€§ï¼ˆæˆå‘˜å˜é‡ï¼‰

å¦‚æœæˆå‘˜å±æ€§åœ¨å£°æ˜æ—¶åŠ **å…³é”®å­—mutableä¿®é¥°**åï¼Œåœ¨å¸¸å‡½æ•°ä¸­ä»**å¯ä»¥ä¿®æ”¹**

#### **è¯­æ³•**ï¼š

`è¿”å›å€¼ç±»å‹ å‡½æ•°å( ) const`



> [!IMPORTANT]
>
> > ç”±å‰æ–‡çš„â€œthisæŒ‡é’ˆâ€å¾—çŸ¥ï¼šthisæŒ‡é’ˆçš„æœ¬è´¨ï¼šæŒ‡é’ˆå¸¸é‡ï¼Œå³ï¼š`ç±»å *const this` 
> >
> > thisæŒ‡é’ˆ æœ¬èº«çš„å€¼ä¸èƒ½ä¿®æ”¹ï¼ˆä¹Ÿå°±æ˜¯ä¸èƒ½ä¿®æ”¹thisæŒ‡é’ˆ**æŒ‡å‘è°**ï¼‰ï¼Œ`this=NULL;//é”™`
> >
> > ä½†æ˜¯èƒ½ä¿®æ”¹ thisæŒ‡é’ˆ æ‰€æŒ‡å‘å˜é‡çš„å€¼ï¼ˆä¹Ÿå°±æ˜¯èƒ½ä¿®æ”¹thisæŒ‡é’ˆ**æŒ‡å‘å¯¹è±¡çš„å±æ€§**ï¼‰`this->age=a;//å¯¹`
>
> 
>
> é‚£ä¹ˆï¼Œå¦‚æœæƒ³è®© ***thisæŒ‡é’ˆ æ‰€æŒ‡å‘å˜é‡çš„å€¼*** ä¹Ÿä¸èƒ½ä¿®æ”¹ï¼Œ
>
> å°±åº”è¯¥ç”¨`const ç±»å* const this` ï¼ˆæˆ–è€…è¯´ï¼šthisæŒ‡é’ˆçš„ç±»å‹åº”è¯¥ä¸ºï¼š`const ç±»å* const`ï¼‰
>
> 
>
> é—®é¢˜æ¥äº†ï¼šè¿™ä¸ª**å¤šåŠ çš„`const`**,åœ¨å‡½æ•°å£°æ˜(æˆ–è€…å‡½æ•°å®šä¹‰çš„ç¬¬ä¸€è¡Œ)ä¸­ï¼Œåº”è¯¥æ”¾åœ¨å“ªé‡Œå‘¢ï¼Ÿ
>
> | å‡½æ•°å£°æ˜(æˆ–è€…å‡½æ•°å®šä¹‰çš„ç¬¬ä¸€è¡Œ)ï¼š | A    | è¿”å›å€¼ç±»å‹ | å‡½æ•°å | ï¼ˆBï¼‰ | C    |
> | -------------------------------- | ---- | ---------- | ------ | ----- | ---- |
>
> è‹¥æ”¾åœ¨Aä½ç½®ï¼Œå®¹æ˜“è¯¯ä»¥ä¸ºæ˜¯ä¿®é¥°è¿”å›å€¼çš„
>
> è‹¥æ”¾åœ¨Bä½ç½®ï¼Œå®¹æ˜“è¯¯ä»¥ä¸ºæ˜¯ä¿®é¥°å½¢å‚çš„
>
> è‹¥æ”¾åœ¨Cä½ç½®ï¼Œæ— æ­§ä¹‰ï¼Œæ‰€ä»¥æœ€ç»ˆè§„å®šæ”¾åœ¨Cä½ç½®
>
> 
>
> æ‰€ä»¥ï¼Œ**å¸¸å‡½æ•°**çš„å£°æ˜(æˆ–è€…å‡½æ•°å®šä¹‰çš„ç¬¬ä¸€è¡Œ)çš„**è¯­æ³•**ï¼š
>
> `è¿”å›å€¼ç±»å‹ å‡½æ•°å( ) const`



ç¤ºä¾‹ä»£ç ï¼š

```c++
class Person{
public:
    int m_a;//åœ¨å¸¸å‡½æ•°ä¸­ä»**ä¸å¯ä»¥ä¿®æ”¹**
    mutable int m_b;//åŠ **å…³é”®å­—mutableä¿®é¥°**ï¼Œåœ¨å¸¸å‡½æ•°ä¸­ä»**å¯ä»¥ä¿®æ”¹**

    void func() const//å¸¸å‡½æ•°
    {
        //this->m_a=10;//æˆ–è€… â€˜m_a=10;â€™//éƒ½æŠ¥é”™
        this->m_b=10;//æˆ–è€… â€˜m_b=10;â€™//éƒ½ä¸æŠ¥é”™
    }
};
```



### å¸¸å¯¹è±¡ï¼ˆç”¨`const`ä¿®é¥°çš„å¯¹è±¡ï¼‰

#### Whatï¼š

`const`+å¯¹è±¡=>**å¸¸å¯¹è±¡**

#### ä½œç”¨ï¼š

- å¸¸å¯¹è±¡åªå¯ä»¥ä¿®æ”¹ åŠ **å…³é”®å­—mutableä¿®é¥°**çš„æˆå‘˜å±æ€§ï¼›ä¸å¯ä»¥ä¿®æ”¹æ™®é€šæˆå‘˜å±æ€§ã€‚
- **å¸¸å¯¹è±¡åªèƒ½è°ƒç”¨å¸¸å‡½æ•°**ï¼›ä¸èƒ½è°ƒç”¨æ™®é€šæˆå‘˜å‡½æ•°ï¼Œå› ä¸ºæ™®é€šæˆå‘˜å‡½æ•°å¯ä»¥ä¿®æ”¹æ™®é€šæˆå‘˜å±æ€§ã€‚

> [!CAUTION]
>
> å¸¸å¯¹è±¡åªèƒ½è°ƒç”¨å¸¸å‡½æ•°
>
> é`const`å¯¹è±¡å¯ä»¥è°ƒç”¨å¸¸å‡½æ•°ï¼Œä¹Ÿå¯ä»¥è°ƒç”¨éå¸¸å‡½æ•°

#### è¯­æ³•ï¼š

`const ç±»å å¯¹è±¡å`

ç¤ºä¾‹ä»£ç ï¼š

```c++
class Person{
public:
    int m_a;
    mutable int m_b;

    Person():m_a(0),m_b(0){}
    void func1() const
    {
        //this->m_a=10;//æˆ–è€… â€˜m_a=10;â€™//éƒ½æŠ¥é”™
        this->m_b=10;//æˆ–è€… â€˜m_b=10;â€™//éƒ½ä¸æŠ¥é”™
    }
    void func2()
    {
        cout<<"func2"<<endl;
    }

};

void test()
{
    const Person p; //å¸¸å¯¹è±¡
    p.m_b=1;//å¸¸å¯¹è±¡å¯ä»¥ä¿®æ”¹ åŠ **å…³é”®å­—mutableä¿®é¥°**çš„æˆå‘˜å±æ€§
    //p.m_a=100;//å¸¸å¯¹è±¡ä¸å¯ä»¥ä¿®æ”¹æ™®é€šæˆå‘˜å±æ€§ï¼Œæ‰€ä»¥æŠ¥é”™

    p.func1();//å¸¸å¯¹è±¡åªèƒ½è°ƒç”¨å¸¸å‡½æ•°
    //p.func2();//å¸¸å¯¹è±¡ä¸èƒ½è°ƒç”¨æ™®é€šæˆå‘˜å‡½æ•°ï¼Œæ‰€ä»¥æŠ¥é”™
    cout<<"p.m_a="<<p.m_a<<endl;
    cout<<"p.m_b="<<p.m_b<<endl;
}

int main()
{
    test();
    return 0;
}
```

è¿è¡Œç»“æœï¼š

```cmd
p.m_a=0
p.m_b=10
```



## ç±»ä¸­staticä¸constå…³é”®å­—çš„å¯¹æ¯”

<img src="C++ç±»çš„ç®€ä»‹.assets/1407db1c99c30c11443a1762067638c-1745155463688-2.jpg" alt="1407db1c99c30c11443a1762067638c" style="zoom:150%;" />



## å‹å…ƒ

>**æ¦‚å¿µ**ï¼šè®©ç±»å¤–çš„å‡½æ•°æˆ–è€…å…¶ä»–ç±»**ä¹Ÿèƒ½è®¿é—®ç§æœ‰å±æ€§**

### 3ç§å®ç°æ–¹å¼ï¼š

| 3ç§å®ç°æ–¹å¼                     | å‹å…ƒå£°æ˜çš„è¯­æ³•                 | ç¤ºä¾‹                                      |
| ------------------------------- | ------------------------------ | ----------------------------------------- |
| **å…¨å±€å‡½æ•°** åšå‹å…ƒ             | `friend å…¨å±€å‡½æ•°æ™®é€šçš„å£°æ˜;`   | `friend void printMoney(Person p);`       |
| **å…¶ä»–ç±» **åšå‹å…ƒ               | `friend class ç±»å;`           | `friend class Parent;`                    |
| **å…¶ä»–ç±»ä¸­çš„*æˆå‘˜å‡½æ•°*** åšå‹å…ƒ | `friend æˆå‘˜å‡½æ•°åœ¨ç±»å¤–çš„å£°æ˜;` | `friend void Bank::checkMoney(Person p);` |

æ— è®ºå“ªç§å®ç°æ–¹å¼ï¼Œæœ¬è´¨ä¸Šéƒ½æ˜¯ `friend `+ `å£°æ˜`ï¼›

ç¤ºä¾‹ä»£ç ï¼š

```c++
#include<iostream>
#include<string>
using namespace std;

//ç±»çš„å£°æ˜ï¼Œå¯ä»¥é¿å…ç±»å®šä¹‰æ—¶çš„é¡ºåºé€ æˆæŠ¥é”™çš„é—®é¢˜
class Person;
class Parent;
class Bank;

class Bank{
public:
    string m_BankName;
    Bank(string name):m_BankName(name){}

    void checkMoney(Person p);//å…ˆå£°æ˜ï¼Œåå®ç°ï¼Œä»è€Œé¿å… â€œPersonç±»ä¸å®Œæ•´å®ç°â€œ çš„æŠ¥é”™
};

class Person{
    //å‹å…ƒå£°æ˜
    friend void printMoney(Person p);        //**å…¨å±€å‡½æ•°** åšå‹å…ƒ
    friend class Parent;                     //**å…¶ä»–ç±»** åšå‹å…ƒ
    friend void Bank::checkMoney(Person p); //**å…¶ä»–ç±»ä¸­çš„*æˆå‘˜å‡½æ•°*** åšå‹å…ƒ

public:
    string m_name;
private:
    int m_money;
public:
    Person(string name,int money):m_name(name),m_money(money){}
};

class Parent{
public:
    string m_ParentName;
    Parent(string name):m_ParentName(name){}
    
    void checkMoney(Person p)
    {
        cout<<p.m_name<<" has "<<"$"<<p.m_money <<endl;
    }
};

//å…ˆåœ¨å‰é¢Bankç±»çš„å®ç°ä¸­å£°æ˜ï¼Œåé¢æ‰å®ç°ï¼Œä»è€Œé¿å… â€œPersonç±»ä¸å®Œæ•´å®ç°â€œ çš„æŠ¥é”™
void Bank::checkMoney(Person p)
{
    cout<<p.m_name<<" has "<<"$"<<p.m_money <<" in "<<m_BankName<<endl;
}

//å…¨å±€å‡½æ•°
void printMoney(Person p)
{
    cout<<p.m_name<<" has "<<"$"<<p.m_money <<endl;
}

int main()
{
    Person p1("ppp",100);
    printMoney(p1);
    Parent par1("par");
    par1.checkMoney(p1);
    Bank b1("bbb");
    b1.checkMoney(p1);
    return 0;
}
```

è¿è¡Œç»“æœï¼š

```cmd
ppp has $100
ppp has $100
ppp has $100 in bbb
```





## è¿ç®—ç¬¦é‡è½½

> What
>
> è¿ç®—ç¬¦é‡è½½æ˜¯å…è®¸ä½ ä¸ºè‡ªå®šä¹‰ç±»å‹ï¼ˆæ¯”å¦‚ç±»ï¼‰å®šä¹‰æ ‡å‡†è¿ç®—ç¬¦ï¼ˆå¦‚ `+`, `-`, `[]`, `*` ç­‰ï¼‰åœ¨ç‰¹å®šç±»å‹ä¸Šçš„è¡Œä¸ºã€‚
>
> é€šè¿‡è¿ç®—ç¬¦é‡è½½ï¼Œå¯ä»¥è®©**è‡ªå®šä¹‰ç±»å‹**åƒå†…å»ºç±»å‹ä¸€æ ·**ä½¿ç”¨å¸¸è§çš„è¿ç®—ç¬¦**ã€‚



### å¯ä»¥é‡è½½çš„è¿ç®—ç¬¦

![image-20250401081554450](C++ç±»çš„ç®€ä»‹.assets/image-20250401081554450-1743466558924-1.png)

### ä¸å¯ä»¥é‡è½½çš„è¿ç®—ç¬¦

<img src="C++ç±»çš„ç®€ä»‹.assets/image-20250401081708389-1743466632673-3.png" alt="image-20250401081708389" style="zoom: 50%;" />



### å…¶ä»–é™åˆ¶ï¼š

- ä¸èƒ½åˆ›å»ºæ–°è¿ç®—ç¬¦ï¼Œä¾‹å¦‚ ******ã€ **<>**ã€ **&|**
- è¿ç®—ç¬¦ **&&** ä¸ **||** çš„é‡è½½å¤±å»çŸ­è·¯æ±‚å€¼
- é‡è½½çš„è¿ç®—ç¬¦ **->** å¿…é¡»è¦ä¹ˆè¿”å›è£¸æŒ‡é’ˆï¼Œè¦ä¹ˆï¼ˆæŒ‰å¼•ç”¨æˆ–å€¼ï¼‰è¿”å›åŒæ ·é‡è½½äº†è¿ç®—ç¬¦ **->** çš„å¯¹è±¡
- **ä¸èƒ½æ›´æ”¹**è¿ç®—ç¬¦çš„**ä¼˜å…ˆçº§**ã€**ç»“åˆæ–¹å‘(ç»“åˆæ€§)**æˆ–**æ“ä½œæ•°çš„æ•°é‡**ï¼Œå¯ä»¥æ”¹å˜**æ“ä½œæ•°çš„ç±»å‹**



### é‡è½½è¿ç®—ç¬¦çš„2ç§æ–¹å¼ï¼š

- æ–¹æ³•ä¸€ï¼šé€šè¿‡**æˆå‘˜å‡½æ•°**æ¥é‡è½½è¿ç®—ç¬¦
- æ–¹æ³•äºŒï¼šé€šè¿‡**å…¨å±€å‡½æ•°**æ¥é‡è½½è¿ç®—ç¬¦

#### é‡è½½æ–¹å¼æœ‰è§„å®šçš„è¿ç®—ç¬¦

> [!IMPORTANT]
>
> ç‰¹åˆ«åœ°ï¼Œ
>
> `=`ã€`[]`ã€`()`ã€`-ï¼`ã€**ç±»å‹è½¬æ¢** è¿ç®—ç¬¦çš„é‡è½½å‡½æ•°å¿…é¡»æ˜¯**ç±»æˆå‘˜å‡½æ•°**
>
> `<<`ã€`>>`ä¸ºäº†èƒ½å¤Ÿç¬¦åˆæƒ¯ç”¨çš„è°ƒç”¨æ–¹å¼ `cout<<a`ï¼Œæ‰€ä»¥è¦ä½¿ç”¨**å‹å…ƒå‡½æ•°**æ¥é‡è½½ã€‚ä½†å…¶å®ä¹Ÿå¯ä»¥ç”¨ç±»æˆå‘˜å‡½æ•°æ¥é‡è½½ï¼Œåªæ˜¯è°ƒç”¨æ–¹å¼ä¸ç¬¦åˆä¹ æƒ¯ã€‚



### å¸¸è§çš„è¿ç®—ç¬¦é‡è½½ç¤ºä¾‹

#### 1. é‡è½½ `+` è¿ç®—ç¬¦ï¼š

æ–¹æ³•ä¸€ï¼šé€šè¿‡**æˆå‘˜å‡½æ•°**æ¥é‡è½½è¿ç®—ç¬¦+

è°ƒç”¨æ–¹æ³•ï¼š

æ–¹æ³•1ï¼ˆç®€åŒ–æ–¹æ³•ï¼‰ï¼š`c3=c1+c2;`
æ–¹æ³•2ï¼š `c3=c1.operator+(c2);`



æ–¹æ³•äºŒï¼šé€šè¿‡**å…¨å±€å‡½æ•°**æ¥é‡è½½è¿ç®—ç¬¦+

è°ƒç”¨æ–¹æ³•ï¼š

æ–¹æ³•1ï¼ˆç®€åŒ–æ–¹æ³•ï¼‰ï¼š`c3=c1+c2;`

æ–¹æ³•2ï¼š `c3=operator+(c1,c2);`

> [!NOTE]
>
> `-` `*`ç­‰è¿ç®—ç¬¦çš„é‡è½½ç±»ä¼¼



##### ç¤ºä¾‹ï¼šè¡¨ç¤ºå¤æ•°çš„åŠ æ³•

æ–¹æ³•ä¸€ï¼šé€šè¿‡**æˆå‘˜å‡½æ•°**æ¥é‡è½½è¿ç®—ç¬¦+

```c++
#include<iostream>

using namespace std;

class Complex{
public:
    double real;
    double imag;
    Complex(double r=0,double i=0):real(r), imag(i){}

    Complex operator+(Complex& c2)//é€šè¿‡æˆå‘˜å‡½æ•°æ¥é‡è½½è¿ç®—ç¬¦+
    {
        return Complex(real+c2.real,imag+c2.imag);
    }

    void printComplex()
    {
        cout<<real<<'+'<<imag<<'i'<<endl;
    }
};

int main()
{
    Complex c1(0.3,0.4),c2(3,4);

    //è°ƒç”¨æ–¹æ³•ï¼š
    Complex c3=c1+c2;//æ–¹æ³•1ï¼šç®€åŒ–
    //Complex c3=c1.operator+(c2);//æ–¹æ³•2
    
    c3.printComplex();
    return 0;
}
```

åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œ`operator+` è¢«ç”¨æ¥é‡è½½ `+` è¿ç®—ç¬¦ï¼Œè¡¨ç¤ºä¸¤ä¸ªå¤æ•°çš„åŠ æ³•ã€‚

- `Complex operator+ (Complex& other)` æ˜¯ `operator+` è¿ç®—ç¬¦çš„é‡è½½ç‰ˆæœ¬ï¼Œå®ƒå®šä¹‰äº†ä¸¤ä¸ªå¤æ•°ç›¸åŠ çš„è¡Œä¸ºã€‚
- åœ¨ `main()` å‡½æ•°ä¸­ï¼Œ`c1 + c2` å°±ä¼šè°ƒç”¨ `operator+`ï¼Œå¹¶è¿”å›ä¸€ä¸ªæ–°çš„å¤æ•°å¯¹è±¡ `c3`ã€‚



æ–¹æ³•äºŒï¼šé€šè¿‡**å…¨å±€å‡½æ•°**æ¥é‡è½½è¿ç®—ç¬¦+

```c++
#include<iostream>
#include<string>
using namespace std;

class Complex{
public:
    double real;
    double imag;
    Complex(double r=0,double i=0):real(r), imag(i){}

    void printComplex()
    {
        cout<<real<<'+'<<imag<<'i'<<endl;
    }
};

Complex operator+(Complex& c1,Complex& c2)//é€šè¿‡å…¨å±€å‡½æ•°æ¥é‡è½½è¿ç®—ç¬¦+
{
    return Complex(c1.real+c2.real,c1.imag+c2.imag);
}

int main()
{
    Complex c1(0.3,0.4),c2(3,4);

    //è°ƒç”¨æ–¹æ³•ï¼š
    Complex c3=c1+c2;//æ–¹æ³•1ï¼šç®€åŒ–
    //Complex c3=operator+(c1,c2);//æ–¹æ³•2
    
    c3.printComplex();
    return 0;
}
```

ä¸¤ç§æ–¹æ³•æœ€ç»ˆçš„æ•ˆæœç›¸åŒ



##### ä¸¤ç§æ–¹æ³•çš„å¯¹æ¯”

| æ¯”è¾ƒé¡¹ç›®             | é€šè¿‡**æˆå‘˜å‡½æ•°**æ¥é‡è½½è¿ç®—ç¬¦+ | é€šè¿‡**å…¨å±€å‡½æ•°**æ¥é‡è½½è¿ç®—ç¬¦+        |
| -------------------- | ----------------------------- | ------------------------------------ |
| åŒï¼šç®€åŒ–çš„è°ƒç”¨æ–¹æ³•   | `c3=c1+c2;`                   | `c3=c1+c2;`                          |
| å¼‚ï¼šéç®€åŒ–çš„è°ƒç”¨æ–¹æ³• | `c3=c1.operator+(c2);`        | `c3=operator+(c1,c2);`               |
| å¼‚ï¼šè®¿é—®æƒé™         | å¯ä»¥è®¿é—®ç§æœ‰å±æ€§              | ä¸å¯ä»¥è®¿é—®ç§æœ‰å±æ€§ï¼Œé™¤éè¿›è¡Œå‹å…ƒå£°æ˜ |

ç›¸æ¯”ä¹‹ä¸‹ï¼Œé€šè¿‡**æˆå‘˜å‡½æ•°**æ¥é‡è½½è¿ç®—ç¬¦+ æ›´åŠ æ–¹ä¾¿ï¼Œå¯ä»¥è®¿é—®æ‰€æœ‰ç§æœ‰å±æ€§



#### 2.é‡è½½ `<<` è¿ç®—ç¬¦ï¼šç”¨äºè¾“å‡º

```c++
#include<iostream>
#include<string>
using namespace std;

class Person{
    friend ostream& operator<<(ostream& out,Person& p);//å‹å…ƒå£°æ˜
private:
    int age;
    string name;
public:
    Person(int a=0,string n=""):age(a),name(n){}
};

//åˆ©ç”¨å…¨å±€å‡½æ•°é‡è½½<<
ostream& operator<<(ostream& out,Person& p)
{
    out<<p.name<<" is "<<p.age<<" years old.";
    return out;
}

int main()
{
    Person p1(10,"whY");
    cout<<p1<<endl;
    return 0;
}
```

> [!CAUTION]
>
> **æ³¨æ„äº‹é¡¹ï¼š**
>
> 1.è¾“å‡ºæµç±»å‹ï¼š***ostream***
>
> 
>
> 2.è¿”å›å€¼ç±»å‹ï¼š***ostream***&
>
> Why?
>
> å¦‚æœè¿”å›å€¼ç±»å‹æ˜¯***void***
>
> é‚£ä¹ˆè°ƒç”¨åªèƒ½æ˜¯ `cout<<p1`,è€Œä¸èƒ½æ˜¯ `cout<<p1<<endl` æˆ– `cout<<p1<<"Hello"<<endl`
>
> å› ä¸ºåªæœ‰å½“è¿”å›å€¼æ˜¯è¾“å‡ºæµ***ostream***æ—¶ï¼Œæ‰èƒ½**ä¸æ–­è¾“å‡º**
>
> 
>
> 3.ç”±äºè¾“å…¥è¾“å‡ºæµåˆ†åˆ«éƒ½**åªæœ‰1ä¸ª**ï¼Œæ‰€ä»¥**å½¢å‚**å’Œ**è¿”å›å€¼**å¿…é¡»éƒ½æ˜¯**å¼•ç”¨&**
>
> 
>
> 4.å‡½æ•°ä¸­è¾“å‡ºæµçš„åç§°å¯ä»¥ä»»æ„
>
> ä¹Ÿå°±æ˜¯è¯´ï¼šä¸‹é¢ä»£ç ä¸­çš„`out`ï¼Œå¯ä»¥æ¢æˆå…¶ä»–åç§°
>
> å› ä¸ºï¼Œè¿™åªæ˜¯ä¸€ä¸ªå¼•ç”¨
>
> ```c++
> ostream& operator<<(ostream& out)
> {
>  out<<name<<" is "<<age<<" years old.";
>  return out;
> }
> ```
>
> 
>
> 5.æœ€å¥½ç”¨**å…¨å±€å‡½æ•°**é‡è½½<<ï¼Œè€Œä¸æ˜¯ç”¨**æˆå‘˜å‡½æ•°**
>
> Why?
>
> å…¶å®ä¹Ÿå¯ä»¥åˆ©ç”¨æˆå‘˜å‡½æ•°é‡è½½<<
>
> ```c++
> //åˆ©ç”¨æˆå‘˜å‡½æ•°é‡è½½<<
> ostream& operator<<(ostream& out)
> {
>  out<<name<<" is "<<age<<" years old.";
>  return out;
> }
> ```
>
> ä½†æ˜¯ï¼Œåœ¨è°ƒç”¨æ—¶ï¼Œcoutåœ¨å³è¾¹
>
> ```c++
> p1<<cout;//'p1.operator<<(cout)'çš„ç®€åŒ–ç‰ˆ
> ```
>
> ä¸æˆ‘ä»¬**ä¹ æƒ¯çš„coutåœ¨å·¦è¾¹**ä¸åŒ
>
> 
>
> ä½†æ˜¯ç”¨**å…¨å±€å‡½æ•°**é‡è½½<<ï¼Œåˆ™å¯ä»¥å®ç°coutåœ¨å·¦è¾¹
>
> 
>
> æ‰€ä»¥ï¼Œæœ€å¥½ç”¨**å…¨å±€å‡½æ•°**é‡è½½<<



#### 3.é‡è½½`>>`è¿ç®—ç¬¦ï¼šç”¨äºè¾“å…¥

é‡è½½`>>`,`<<`çš„æ¯”è¾ƒ

|        | >> ç”¨äºè¾“å…¥  | << ç”¨äºè¾“å‡º                          | å¼‚åŒç‚¹                                                       |
| ------ | ------------ | ------------------------------------ | ------------------------------------------------------------ |
| è¿”å›å€¼ | `istream&`   | `ostream&`                           | åŒï¼šéƒ½è¦è¿”å› **è¾“å…¥æµæˆ–è¾“å‡ºæµçš„å¼•ç”¨**ï¼Œå› ä¸ºè¾“å…¥æµè¾“å‡ºæµåªæœ‰1ä¸ª |
| å½¢å‚1  | `istream&`   | `ostream&`                           | åŒï¼š**è¾“å…¥æµæˆ–è¾“å‡ºæµçš„å¼•ç”¨** ä½œä¸ºç¬¬ä¸€ä¸ªå½¢å‚                  |
| å½¢å‚2  | `classname&` | `const classname&` æˆ–è€… `classname&` | åŒï¼šéƒ½æ˜¯ç±»åçš„å¼•ç”¨ã€‚å¼‚ï¼šé‡è½½`>>`ä¸èƒ½ä¼ å…¥`const`ï¼Œå¦åˆ™æ— æ³•ä¿®æ”¹ |

ç¤ºä¾‹ï¼š

```cpp
istream& operator>>(istream& cin,Quaternary& number)
{
    cin>>number.quat_num;
    return cin;
}

ostream& operator<<(ostream& cout,const Quaternary& number)
{
    cout<<number.quat_num;
    return cout;
}
```



#### 4.é‡è½½ `++` è¿ç®—ç¬¦ï¼š



|          | å‰ç½®++                    | åç½®++                                          |
| -------- | ------------------------- | ----------------------------------------------- |
| è¯­æ³•     | `classname& operator++()` | `classname operator++(int)`   ï¼ˆintæ˜¯å ä½å‚æ•°ï¼‰ |
| è¿”å›     | å¼•ç”¨                      | å€¼                                              |
| å‡½æ•°å®ç° | å…ˆé€’å¢ï¼Œå†è¿”å›`*this`     | å…ˆæš‚å­˜å½“å‰å€¼ä¸º`temp`ï¼Œå†é€’å¢ï¼Œæœ€åè¿”å›`temp`    |



##### ç¤ºä¾‹ï¼šè‡ªå®šä¹‰æ•´æ•°

```c++
#include<iostream>
#include<string>
using namespace std;

class MyInteger{
    friend ostream& operator<<(ostream& out,const MyInteger& i);
private:
    int num;
public:
    MyInteger(int n=0):num(n){}

    //é‡è½½å‰ç½®++è¿ç®—ç¬¦
    //è¿”å›çš„æ˜¯å¼•ç”¨
    MyInteger& operator++()
    {
        //å…ˆé€’å¢
        num++;

        //åè¿”å›è‡ªèº«
        return *this;
    }

    //é‡è½½åç½®++è¿ç®—ç¬¦
    //intæ˜¯å ä½å‚æ•°ï¼Œç”¨æ¥åŒºåˆ†å‰ç½®å’Œåç½®é€’å¢
    //è¿”å›çš„æ˜¯å€¼
    MyInteger operator++(int)
    {
        //å…ˆè®°å½•å½“å‰çš„å€¼
        MyInteger temp=*this;

        //å†é€’å¢
        num++;

        //æœ€åè¿”å›temp
        return temp;
    }
};

ostream& operator<<(ostream& out,const MyInteger& i)
{
    out<<i.num;
    return out;
}

void test1()
{
    int i1=0;
    MyInteger my_i1(0);
    cout<<"++(++i1):"<< ++(++i1) <<endl;
    cout<<"i1:"<< i1 <<endl;
    cout<<"++(++my_i1):"<< ++(++my_i1) <<endl;
    cout<<"my_i1:"<< my_i1 <<endl;

    int i2=0;
    MyInteger my_i2(0);
    cout<<"i2++:"<< i2++ <<endl;
    cout<<"i2:"<< i2 <<endl;
    cout<<"my_i2++:"<< my_i2++ <<endl;
    cout<<"my_i2++:"<< my_i2 <<endl;

}

int main()
{
    test1();
    return 0;
}
```

è¿è¡Œç»“æœ

```cmd
++(++i1):2
i1:2
++(++my_i1):2
my_i1:2
i2++:0
i2:1
my_i2++:0
my_i2++:1
```



> [!CAUTION]
>
> é‡è½½**å‰ç½®**++è¿ç®—ç¬¦çš„**æ³¨æ„äº‹é¡¹ï¼š**
>
> ```c++
> //é‡è½½å‰ç½®++è¿ç®—ç¬¦
> //è¿”å›çš„æ˜¯å¼•ç”¨
> MyIntegar& operator++()
> {
>     //å…ˆé€’å¢
>     num++;
> 
>     //åè¿”å›è‡ªèº«
>     return *this;
> }
> ```
>
> 
>
> 1.è¿”å›çš„æ˜¯**å¼•ç”¨**
>
> Why?
>
> å¦‚æœè¿”å›çš„ä¸æ˜¯å¼•ç”¨`MyIntegar&`ï¼Œè€Œæ˜¯å€¼`MyIntegar`
>
> ```c++
> //é‡è½½å‰ç½®++è¿ç®—ç¬¦
> //å¦‚æœè¿”å›çš„æ˜¯å€¼
> MyIntegar operator++()
> {
>     //å…ˆé€’å¢
>     num++;
> 
>     //åè¿”å›è‡ªèº«
>     return *this;
> }
> ```
>
> åˆ™ä¼šå¯¼è‡´**é“¾å¼è°ƒç”¨**`++(++my_i1)`æ—¶ï¼Œ**æ— æ³•ä¿®æ”¹è‡ªèº«çš„å€¼**
>
> ```c++
> ++(++my_i1):2
> my_i1:1
> ```



> [!CAUTION]
>
> é‡è½½**åç½®**++è¿ç®—ç¬¦çš„**æ³¨æ„äº‹é¡¹ï¼š**
>
> ```c++
> //é‡è½½åç½®++è¿ç®—ç¬¦
> //intæ˜¯å ä½å‚æ•°ï¼Œç”¨æ¥åŒºåˆ†å‰ç½®å’Œåç½®é€’å¢
> //è¿”å›çš„æ˜¯å€¼
> MyIntegar operator++(int)
> {
>     //å…ˆè®°å½•å½“å‰çš„å€¼
>     MyIntegar temp=*this;
> 
>     //å†é€’å¢
>     num++;
> 
>     //æœ€åè¿”å›temp
>     return temp;
> }
> ```
>
> 1.è¿”å›çš„æ˜¯**å€¼**ï¼Œè€Œ**ä¸æ˜¯*å¼•ç”¨***
>
> Why?
>
> å¦‚æœè¿”å›å¼•ç”¨ï¼Œé‚£ä¹ˆå°±æ˜¯è¿”å›äº†**å±€éƒ¨å˜é‡`temp`çš„å¼•ç”¨**ï¼Œä¼šæŠ¥é”™ï¼
>
> 
>
> 2.å¦‚ä½•åŒºåˆ†å‰ç½®å’Œåç½®é€’å¢ï¼Ÿ
>
> intæ˜¯**å ä½å‚æ•°**ï¼Œç”¨æ¥åŒºåˆ†å‰ç½®å’Œåç½®é€’å¢
>
> **åªèƒ½**ç”¨`int`,
>
> `double`,`float`,`char`**éƒ½ä¸å¯ä»¥**
>
> 
>
> 3.è¿™æ—¶çš„é‡è½½`<<`è¿ç®—ç¬¦ æ‰€ä¼ å…¥çš„å¯¹è±¡è¦åŠ `const`
>
> ```
> ostream& operator<<(ostream& out,const MyIntegar& i)
> {
>     out<<i.num;
>     return out;
> }
> ```
>
> Whyç”¨`const MyIntegar& i`ï¼Œè€Œä¸èƒ½ç”¨`MyIntegar& i`?
>
> åŠ äº†`const`ï¼Œç¡®ä¿ä¸ä¼šä¿®æ”¹ä¼ å…¥çš„å¯¹è±¡ï¼Œå¹¶ä¸”å¯ä»¥å¤„ç†**å¸¸é‡å¯¹è±¡**å’Œ**ä¸´æ—¶å¯¹è±¡**ã€‚ï¼ˆåœ¨è¿™é‡Œæ˜¯ä¸ºäº†å¤„ç†**ä¸´æ—¶å¯¹è±¡**ï¼‰
>





#### **5. **é‡è½½`=`è¿ç®—ç¬¦

>åœ¨åˆ›å»ºä¸€ä¸ªç±»æ—¶ï¼Œç¼–è¯‘å™¨ä¼šè‡ªåŠ¨åŠ ä¸Š4ä¸ªå‡½æ•°ï¼š
>
>1. é»˜è®¤æ„é€ å‡½æ•°ï¼ˆå‰æ–‡å·²è®²ï¼‰
>2. æœ‰å‚æ„é€ å‡½æ•°ï¼ˆå‰æ–‡å·²è®²ï¼‰
>3. æ‹·è´æ„é€ å‡½æ•°ï¼ˆå‰æ–‡å·²è®²ï¼‰
>4. é‡è½½`=`è¿ç®—ç¬¦ï¼Œè§ä»¥ä¸‹ä»£ç ï¼š
>
>```c++
>class Person{
>public:
>    int *m_Age;
>    Person(int age)
>    {
>        m_Age=new int (age);//åœ¨å †åŒºå¼€è¾Ÿä¸€å—å†…å­˜
>    }
>    ~Person()
>    {
>        if(m_Age!=NULL)
>        {
>            delete m_Age;
>            m_Age=NULL;
>        }
>    }
>};
>void test1()
>{
>    Person p1(18);
>    Person p2(100);
>    p2=p1;//ç¼–è¯‘å™¨æä¾›äº†ä¸€ä¸ªé‡è½½=è¿ç®—ç¬¦çš„å‡½æ•°
>    cout<<"p2's age is "<<*p2.m_Age<<endl;
>}
>int main()
>{
>    test1();
>    return 0;
>}
>
>```
>
>ç”±`p2=p1;`å¯è§ï¼Œç¼–è¯‘å™¨ä¼šè‡ªåŠ¨æä¾›äº†ä¸€ä¸ªé‡è½½=è¿ç®—ç¬¦çš„å‡½æ•°ï¼Œç”¨äºåŒä¸€ç±»çš„ä¸åŒå¯¹è±¡ä¹‹é—´çš„èµ‹å€¼
>
>
>
>ä½†æ˜¯ï¼Œè¿™æ ·åšä¼šå¸¦æ¥é—®é¢˜ï¼š
>
>**ç¼–è¯‘å™¨**æä¾›çš„é‡è½½`=`è¿ç®—ç¬¦çš„å‡½æ•°ï¼Œåªå®ç°**æµ…æ‹·è´**
>
>ä¹Ÿå°±æ˜¯`p2=p1;`æœ¬è´¨ä¸Šæ˜¯**æµ…æ‹·è´**ï¼Œ`p2.m_Age`å’Œ`p1.m_Age`æŒ‡å‘çš„æ˜¯**åŒä¸€å—å†…å­˜**
>
>**æ‰€ä»¥åœ¨é‡Šæ”¾å†…å­˜æ—¶ï¼Œä¼šå¯¼è‡´å†…å­˜é‡å¤é‡Šæ”¾**
>
><img src="C++%E7%B1%BB%E7%9A%84%E7%AE%80%E4%BB%8B.assets/image-20250214073006859-1739489412207-1.png" alt="image-20250214073006859" style="zoom: 67%;" />
>
>**è§£å†³æ–¹æ³•ï¼š**
>
>è‡ªå·±å†™ä¸€ä¸ªé‡è½½`=`è¿ç®—ç¬¦çš„å‡½æ•°ï¼Œå®ç°**æ·±æ‹·è´**



é‡è½½`=`è¿ç®—ç¬¦ï¼Œå®ç°**æ·±æ‹·è´**

```c++
Person& operator=(Person& p2)
{
    // //æµ…æ‹·è´çš„ä»£ç 
    // m_Age=p2.m_Age; 

    //å…ˆæŠŠå †åŒºå†…å­˜é‡Šæ”¾å¹²å‡€
    if(m_Age!=NULL)
    {
        delete m_Age;
        m_Age=NULL;
    }

    //æ·±æ‹·è´
    m_Age=new int (*p2.m_Age);

    //è¿”å›å¯¹è±¡è‡ªèº«
    return *this;
}
```

> [!CAUTION]
>
> **æ³¨æ„äº‹é¡¹ï¼š**
>
> 1.åœ¨è¿›è¡Œæ·±æ‹·è´ä¹‹å‰ï¼Œå…ˆæŠŠå †åŒºå†…å­˜é‡Šæ”¾å¹²å‡€ï¼
>
> 
>
> 2.è¿”å›å€¼æ˜¯**å¯¹è±¡è‡ªèº«**çš„å¼•ç”¨
>
> æ‰èƒ½å®ç°**é“¾å¼èµ‹å€¼**ï¼Œæ¯”å¦‚ï¼š`p3=p2=p1;`
>



#### 6.é‡è½½å…³ç³»è¿ç®—ç¬¦ï¼šç”¨äºæ¯”è¾ƒ

```c++
#include<iostream>
using namespace std;

class Complex{
private:
    double real;
    double imag;
public:
    Complex(double r=0,double i=0):real(r),imag(i){}

    //é‡è½½==è¿ç®—ç¬¦
    bool operator==(Complex& c2)
    {
        if(this->real==c2.real && this->imag==c2.imag)
        {
            return true;
        }
        return false;
    }

    //é‡è½½ï¼=è¿ç®—ç¬¦
    bool operator!=(Complex& c2)
    {
        if(this->real==c2.real && this->imag==c2.imag)
        {
            return false;
        }
        return true;
    }
};

int main()
{
    Complex c1(1,2);
    Complex c2(1,2);
    Complex c3(1,3);

    if(c1==c2) cout<<"c1==c2"<<endl;
    else cout<<"c1!=c2"<<endl;

    if(c1!=c3) cout<<"c1!=c3"<<endl;
    else cout<<"c1==c3"<<endl;

    return 0;
}
```

> [!CAUTION]
>
> **æ³¨æ„äº‹é¡¹ï¼š**
>
> 1.è¿”å›å€¼ç±»å‹æ˜¯ï¼š***bool***



#### 7.**é‡è½½ `[]` è¿ç®—ç¬¦ï¼šè¡¨ç¤ºæ•°ç»„çš„è®¿é—®ï¼ˆè¿”å›å…ƒç´ å¼•ç”¨ï¼‰**

![image-20250415093116718](C++ç±»çš„ç®€ä»‹.assets/image-20250415093116718-1744680680339-1.png)



å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ª `SqList` ç±»ï¼Œè¡¨ç¤ºä¸€ä¸ªæ•´å‹æ•°ç»„ï¼Œæˆ‘ä»¬æƒ³è¦é€šè¿‡ `[]` è¿ç®—ç¬¦è®¿é—®æ•°ç»„çš„å…ƒç´ ï¼š

```c++
#include <iostream>
#include <vector>
using namespace std;

class SqList {
private:
    vector<int> data;

public:
    // æ„é€ å‡½æ•°ï¼Œåˆå§‹åŒ–ä¸€ä¸ªæ•°ç»„
    SqList(size_t size) : data(size) {}

    // é‡è½½ [] è¿ç®—ç¬¦ï¼ˆéconst ç‰ˆæœ¬ï¼‰ï¼Œè¿”å›å…ƒç´ çš„å¼•ç”¨ã€‚
    // ç”¨äºä¿®æ”¹åˆ—è¡¨ä¸­çš„å…ƒç´ 
    int& operator [] (size_t i) {
        if (i >= data.size()) {
            throw out_of_range("Index out of range");//throw:ç”¨äºæŠ›å‡ºå¼‚å¸¸çš„å…³é”®å­—
        }
        return data[i];  // è¿”å›å…ƒç´ å¼•ç”¨
    }

    // é‡è½½ [] è¿ç®—ç¬¦ï¼ˆconst ç‰ˆæœ¬ï¼‰ï¼Œä»…è¿”å›å…ƒç´ çš„å€¼ï¼Œä¸èƒ½ä¿®æ”¹è¯¥å…ƒç´ 
    int operator [] (size_t i) const {
        if (i >= data.size()) {
            throw out_of_range("Index out of range");
        }
        return data[i];  // è¿”å›å…ƒç´ å€¼
    }
};

int main() {
    SqList sq(5);  // åˆ›å»ºä¸€ä¸ªå¤§å°ä¸º 5 çš„æ•°ç»„

    //ä¸‹é¢ä¸¤è¡Œè¿ç”¨çš„æ˜¯ï¼šé const ç‰ˆæœ¬ (operator[])
    sq[0] = 10;  // ä¿®æ”¹ç¬¬ 0 ä¸ªå…ƒç´ 
    sq[1] = 20;  // ä¿®æ”¹ç¬¬ 1 ä¸ªå…ƒç´ 

    //ä¸‹é¢è¿ç”¨çš„æ˜¯ï¼šconst ç‰ˆæœ¬ (operator[])
    // è¾“å‡ºæ•°ç»„ä¸­çš„å…ƒç´ 
    cout << "sq[0]: " << sq[0] << endl;  // 10
    cout << "sq[1]: " << sq[1] << endl;  // 20

    const SqList csq(3);
    cout << "csq[0]: " << csq[0] << endl;  // è¾“å‡º 0

    return 0;
}
```



> [!IMPORTANT]
>
> é‡è½½ `[]` è¿ç®—ç¬¦ä¸­ **é`const`** ç‰ˆæœ¬ä¸ **`const`**ç‰ˆæœ¬çš„æ¯”è¾ƒ
>
> -  **é`const`** ç‰ˆæœ¬ï¼š`int& operator[](size_t i)`ï¼šè¿™æ˜¯ä¸€ä¸ªè¿”å›**å…ƒç´ å¼•ç”¨**çš„ `operator[]`ï¼Œ**å…è®¸ä¿®æ”¹æ•°ç»„ä¸­çš„å…ƒç´ **ã€‚
> -  **`const`**ç‰ˆæœ¬ï¼š`int operator[](size_t i) const`ï¼Œè¿™æ˜¯ä¸€ä¸ª `const` ç‰ˆæœ¬çš„ `operator[]`ï¼Œå®ƒä¿è¯**ä¸èƒ½ä¿®æ”¹ `const` å¯¹è±¡ä¸­çš„å…ƒç´ ï¼Œåªèƒ½è¯»å–å®ƒä»¬**ã€‚



#### 8.é‡è½½`()`è¿ç®—ç¬¦

é‡è½½åçš„ä½¿ç”¨æ–¹å¼éå¸¸åƒå‡½æ•°çš„è°ƒç”¨ï¼Œæ‰€ä»¥ç§°ä¸ºâ€œ**ä»¿å‡½æ•°**â€

```c++
#include<iostream>
#include<string>
using namespace std;

//ç±»
class MyPrint_class{
public:
    //é‡è½½`()`è¿ç®—ç¬¦
    void operator()(string text)
    {
        cout<<text<<endl;
    }
};

//å‡½æ•°
void MyPrint_func(string text)
{
    cout<<text<<endl;
}

int main()
{
    //ç”¨æ™®é€šçš„å¯¹è±¡æ¥è°ƒç”¨
    MyPrint_class myprint_class;
    myprint_class("Hello wolrd");

    //ç”¨åŒ¿åå¯¹è±¡æ¥è°ƒç”¨
    MyPrint_class()("Hello wolrd");
	
    //å‡½æ•°è°ƒç”¨
    MyPrint_func("Hello wolrd");
    return 0;
}
```

è¿è¡Œç»“æœï¼š

```cmd
Hello wolrd
Hello wolrd
Hello wolrd
```

ç”±æ­¤å¯è§ï¼Œ3ç§æ–¹å¼çš„æ•ˆæœç›¸åŒ



#### 9.é‡è½½ç±»å‹è½¬æ¢è¿ç®—ç¬¦

å…·ä½“å¯ä»¥å‚è§ [c++è¿ç®—ç¬¦é‡è½½ï¼ˆ6ï¼‰ -- ç±»å‹è½¬æ¢_c++ é‡è½½ç±»å‹è½¬æ¢-CSDNåšå®¢](https://blog.csdn.net/weixin_68026222/article/details/135970510?ops_request_misc=&request_id=&biz_id=102&utm_term=c++ ç±»å‹è½¬æ¢é‡è½½&utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduweb~default-0-135970510.142^v102^pc_search_result_base1&spm=1018.2226.3001.4187)

##### ç±»å‹è½¬æ¢æ–¹å‘ï¼š

- è‡ªå®šä¹‰ç±» -> åŸºæœ¬ç±»å‹

- è‡ªå®šä¹‰ç±» -> è‡ªå®šä¹‰ç±»




##### è¯­æ³•ï¼š

`operator ç›®æ ‡ç±»å‹å()`

> [!CAUTION]
>
> æ³¨æ„ï¼š
>
> - ä¸å¯ä»¥å¸¦å‚æ•°
> - **ä¸ç”¨å†™è¿”å›å€¼ç±»å‹**ï¼Œä½†æ˜¯æœ‰è¿”å›å€¼ã€‚å› ä¸º **ç±»å‹å å°±æ˜¯ è¿”å›å€¼ç±»å‹**



ç¤ºä¾‹ï¼šComplexè½¬åŒ–ä¸ºdouble

é‡è½½doubleç±»å‹è½¬æ¢

```cpp
Complex::operator double()
{
    cout<<"Complex->double"<<endl;
    return real;
}
```

è°ƒç”¨æ–¹å¼

```cpp
double real_part=double(complex2);

double real_part2=(double) complex2;
```



### æ€»ç»“

#### éœ€è¦è¿”å›å¼•ç”¨çš„è¿ç®—ç¬¦é‡è½½

- `>>`çš„é‡è½½: è¿”å› `istream&`
- `<<`çš„é‡è½½: è¿”å› `ostream&`

- å‰ç½® `++`çš„é‡è½½: è¿”å› `*this`

- `=`çš„é‡è½½: è¿”å›`*this`
- æ‰€æœ‰å¸¦æœ‰ `=`çš„é‡è½½ï¼ŒåŒ…æ‹¬: `+=`,`-=`,`*=`ç­‰ ï¼šè¿”å›`*this`



# ç»§æ‰¿

## ç®€ä»‹

å¥½å¤„ï¼šå‡å°‘é‡å¤ä»£ç 

è¯­æ³•ï¼š`class å­ç±»åç§°ï¼š ç»§æ‰¿æ–¹å¼ çˆ¶ç±»åç§°`

- çˆ¶ç±» åˆç§°ä¸ºï¼šåŸºç±»
- å­ç±» åˆç§°ä¸ºï¼šæ´¾ç”Ÿç±»

ä¾‹å¦‚ï¼š`class Derived: public Base`

ç§°ä¸ºï¼š`Base` ***æ´¾ç”Ÿ*** å‡º `Derived`ï¼Œæˆ–è€…  `Derived` ***ç»§æ‰¿*** äº†`Base`

ç¤ºä¾‹ä»£ç 

```c++
#include<iostream>
#include<string>
using namespace std;

class Base
{
public:
    void row()
    {
        cout<<"_______"<<endl;
    }
    void col()
    {
        cout<<"|";
    }
};

class showA:public Base
{
public:
    void printA()
    {
        cout<<"  A  ";
    }
};

class showB:public Base
{
public:
    void printB()
    {
        cout<<"  B  ";
    }
};

int main()
{
    showA a1;
    
    a1.row();
    a1.col ();
    a1.printA();
    a1.col ();
    cout<<endl;
    a1.row();

    showB b1;
    b1.row();
    b1.col ();
    b1.printB();
    b1.col ();
    cout<<endl;
    b1.row();
    return 0;
}
```



## ç»§æ‰¿æ–¹å¼

å…±3ç§ï¼š

- å…¬å…±ç»§æ‰¿`public`
- ä¿æŠ¤ç»§æ‰¿`protected`
- ç§æœ‰ç»§æ‰¿`private`

> [!IMPORTANT]
>
> å¦‚æœç»§æ‰¿æ–¹å¼ç¼ºçœï¼Œåˆ™é‡‡ç”¨ä¸‹é¢çš„é»˜è®¤ç»§æ‰¿æ–¹å¼ã€‚

### **é»˜è®¤ç»§æ‰¿æ–¹å¼ï¼š**

- **`class` å®šä¹‰çš„ç±»ç»§æ‰¿æ—¶ï¼Œé»˜è®¤æ˜¯ `private` ç»§æ‰¿**
- **`struct` å®šä¹‰çš„ç±»ç»§æ‰¿æ—¶ï¼Œé»˜è®¤æ˜¯ `public` ç»§æ‰¿**



å…·ä½“ä½œç”¨è§ä¸‹å›¾

<img src="C++%E7%B1%BB%E7%9A%84%E7%AE%80%E4%BB%8B.assets/%E7%BB%A7%E6%89%BF%E6%96%B9%E5%BC%8F.png" alt="ç»§æ‰¿æ–¹å¼" style="zoom:80%;" />



ä¸åŒç»§æ‰¿æ–¹å¼ä¸‹ï¼Œçˆ¶ç±»ä¸å­ç±»ä¹‹é—´çš„å…³ç³»è¡¨

| ç»§æ‰¿æ–¹å¼            | çˆ¶ç±»ï¼šå…¬å…±æƒé™`public`             | çˆ¶ç±»ï¼šä¿æŠ¤æƒé™`protected`             | çˆ¶ç±»ï¼šç§æœ‰æƒé™`private` |
| ------------------- | ---------------------------------- | ------------------------------------- | ----------------------- |
| å…¬å…±ç»§æ‰¿`public`    | å­ç±»ï¼šå…¬å…±æƒé™`public`**ï¼ˆsameï¼‰** | å­ç±»ï¼šä¿æŠ¤æƒé™`protected`**ï¼ˆsameï¼‰** | ä¸å¯è®¿é—®                |
| ä¿æŠ¤ç»§æ‰¿`protected` | å­ç±»ï¼šä¿æŠ¤æƒé™`protected`          | å­ç±»ï¼šä¿æŠ¤æƒé™`protected`**ï¼ˆsameï¼‰** | ä¸å¯è®¿é—®                |
| ç§æœ‰ç»§æ‰¿`private`   | å­ç±»ï¼šç§æœ‰æƒé™`private`            | å­ç±»ï¼šç§æœ‰æƒé™`private`               | ä¸å¯è®¿é—®                |

> [!WARNING]
>
> çˆ¶ç±»ä¸­çš„ç§æœ‰æƒé™`private`è™½ç„¶è®¿é—®ä¸åˆ°ï¼Œ
>
> ä½†æ˜¯ä»ç„¶è¢«ç»§æ‰¿ä¸‹å»äº†ï¼Œåªæ˜¯ç¼–è¯‘å™¨æŠŠå®ƒéšè—äº†



çˆ¶ç±»ä¸­æ‰€æœ‰çš„**éé™æ€æˆå‘˜å±æ€§**éƒ½ä¼šè¢«å­ç±»ç»§æ‰¿ï¼Œ

çˆ¶ç±»ä¸­çš„ç§æœ‰å±æ€§ æ˜¯è¢«ç¼–è¯‘å™¨éšè—äº†ï¼Œå› æ­¤è®¿é—®ä¸åˆ°ã€‚ä½†æ˜¯çœŸçš„è¢«ç»§æ‰¿äº†

```c++
class Base
{
public:
    int a;
protected:
    int b;
private:
    int c;
};

class Son1: public Base
{
public:
    int d;
};

int main()
{
    cout<<sizeof(Son1)<<endl;//è¾“å‡ºç»“æœæ˜¯16ï¼Œè¯´æ˜çˆ¶ç±»Baseä¸­çš„å±æ€§a,b,céƒ½è¢«å­ç±»Son1ç»§æ‰¿äº†
    return 0;
}
```



> [!CAUTION]
>
> æ³¨æ„ï¼š
>
> çˆ¶ç±»çš„æ„é€ å‡½æ•°æ˜¯ `protected`çš„ï¼Œä¹Ÿå¯ä»¥è¢«å­ç±»ä½¿ç”¨ï¼Œä½†æ˜¯ä¸èƒ½è¢«å…¶ä»–åœ°æ–¹è®¿é—®ã€‚
>
> ```cpp
> #include<iostream>
> using namespace std;
> 
> class Base {
> protected://æ¢æˆprivateå¿…å®šä¸è¡Œï¼
>     Base() { cout << "A new Base" << endl; }
> };
> 
> class Derived : public Base {
> public:
>     Derived() { cout << "A new Derived" << endl; }
> };
> int main() {
>     Derived d;
>     //Base b;//æŠ¥é”™ï¼
>     return 0;
> }
> ```
>
> åœ¨ `main`å‡½æ•°ä¸­ï¼Œ
>
> 1.`Derived d;`èƒ½æˆåŠŸæ„é€ ä¸€ä¸ª`Derived`å¯¹è±¡ï¼Œå› ä¸ºå®ƒçš„æ„é€ å‡½æ•°æ˜¯ `public`çš„ï¼Œè€Œå®ƒçš„çˆ¶ç±» `Base`çš„æ„é€ å‡½æ•°æ˜¯ `protected`çš„ï¼Œå­ç±»å¯ä»¥è®¿é—®å¾—åˆ°ã€‚ä½†æ˜¯å¦‚æœåŸºç±» `Base`çš„æ„é€ å‡½æ•°æ¢æˆ `private`çš„ï¼Œåˆ™å¿…å®šä¸è¡Œï¼
>
> 2.`Base b;`ä¼šæŠ¥é”™ï¼å› ä¸ºåŸºç±» `Base`çš„æ„é€ å‡½æ•°æ˜¯ `protected`çš„ï¼Œæ— æ³•è®¿é—®ã€‚



## æ¢å¤è®¿é—®æ§åˆ¶æ–¹å¼

![image-20250427211449811](C++ç±»çš„ç®€ä»‹.assets/image-20250427211449811.png)

> [!CAUTION]
>
> ä¸Šè¿°æ–¹å¼ä»…ä½¿ç”¨äºåŸºç±»ä¸­çš„ `public`ã€`protected`æˆå‘˜ã€‚
>
> å¯¹äºåŸºç±»ä¸­çš„**`private`**æˆå‘˜ï¼Œä½¿ç”¨è¿™ç§æ–¹å¼**æ— æ³•æ¢å¤**åŸæ¥çš„è®¿é—®æ§åˆ¶æ–¹å¼ï¼Œå³ï¼šæ´¾ç”Ÿç±»ä»ç„¶ä¸å¯ä»¥è®¿é—®åŸºç±»ä¸­çš„`private`æˆå‘˜



## ä¸€å®šä¸è¢«ç»§æ‰¿

- å‹å…ƒå…³ç³» 
- ç§æœ‰æˆå‘˜
- æ„é€ å‡½æ•°ä¸ææ„å‡½æ•°



## æ´¾ç”Ÿç±»å¯¹è±¡çš„å­˜å‚¨

æ´¾ç”Ÿç±»çš„å¯¹è±¡æ€»æ˜¯ åœ¨**å‰**é¢ å­˜æ”¾**åŸºç±»**ä¸­å®šä¹‰çš„éé™æ€æ•°æ®æˆå‘˜ï¼Œ

åœ¨å…¶ä¹‹å å­˜æ”¾æ´¾ç”Ÿç±»ä¸­å®šä¹‰çš„éé™æ€æ•°æ®æˆå‘˜ã€‚

å³ï¼šæ´¾ç”Ÿç±»æ€»æ˜¯å…ˆè¿›è¡ŒåŸºç±»éƒ¨åˆ†çš„åˆå§‹åŒ–ï¼Œé»˜è®¤ä½¿ç”¨åŸºç±»æ— å‚æ„é€   



## æ´¾ç”Ÿç±»å¯¹è±¡çš„æ„é€ ä¸ææ„

### æ´¾ç”Ÿç±»å¯¹è±¡çš„æ„é€ 

åŸºç±»çš„æ„é€ å‡½æ•°ä¸è¢«ç»§æ‰¿ï¼Œæ´¾ç”Ÿç±»ä¸­éœ€è¦å£°æ˜è‡ªå·±çš„æ„é€ å‡½æ•°  

æ´¾ç”Ÿç±»çš„æ„é€ å‡½æ•°ä¸­ï¼š

- **åª**éœ€è¦å¯¹æœ¬ç±»ä¸­**æ–°å¢æˆå‘˜è¿›è¡Œåˆå§‹åŒ–**ã€‚
- å¯¹ç»§æ‰¿è€Œæ¥çš„åŸºç±»æˆå‘˜çš„åˆå§‹åŒ–æ˜¯é€šè¿‡ç¼–è¯‘åœ¨æ´¾ç”Ÿç±»æ„é€ å‡½æ•°åˆå§‹åŒ–å™¨ä¸­ **è‡ªåŠ¨ä½¿ç”¨æ— å‚æ„é€ å‡½æ•°ï¼ˆæˆ–æ‹·è´æ„é€ ï¼‰**å®Œæˆã€‚

> [!CAUTION]
>
> 1.å¦‚æœåŸºç±»æ²¡æœ‰é»˜è®¤æ„é€ ï¼ˆåŒ…æ‹¬ =deleteï¼‰ï¼Œ åˆ™**ç¼–è¯‘é”™è¯¯**  
>
> 2.åœ¨æ´¾ç”Ÿç±»æ„é€ å‡½æ•°åˆå§‹åŒ–å™¨ä¸­ï¼Œå¯ä»¥**æ˜¾å¼**è°ƒç”¨åŸºç±»çš„é»˜è®¤æ„é€ å‡½æ•°ã€æœ‰å‚æ„é€ å‡½æ•°ã€æˆ–æ‹·è´æ„é€ ï¼›**ä¹Ÿå¯ä»¥ä¸æ˜¾å¼è°ƒç”¨ã€‚**
>
> â€‹    å¦‚æœä¸æ˜¾å¼è°ƒç”¨ï¼Œé‚£ä¹ˆç¼–è¯‘å™¨ä¼š**è‡ªåŠ¨éšå¼åœ°**è°ƒç”¨åŸºç±»çš„**é»˜è®¤æ„é€ å‡½æ•°ï¼ˆæˆ–æ‹·è´æ„é€ ï¼‰**
>
> 
>
> æ€ä¹ˆçŸ¥é“æ˜¯è‡ªåŠ¨éšå¼åœ°è°ƒç”¨åŸºç±»çš„**é»˜è®¤æ„é€ å‡½æ•°**è¿˜æ˜¯**æ‹·è´æ„é€ **ï¼Ÿ
>
> è§†æ´¾ç”Ÿç±»çš„è°ƒç”¨æƒ…å†µè€Œå®šï¼š
>
> - å¦‚æœ ***æ´¾ç”Ÿç±»*** è°ƒç”¨çš„æ˜¯**é»˜è®¤æ„é€ å‡½æ•°oræœ‰å‚æ„é€ å‡½æ•°**ï¼Œåˆ™è‡ªåŠ¨éšå¼è°ƒç”¨ ***åŸºç±»*** çš„**é»˜è®¤æ„é€ å‡½æ•°**ï¼›
> - å¦‚æœ ***æ´¾ç”Ÿç±»*** è°ƒç”¨çš„æ˜¯**æ‹·è´æ„é€ å‡½æ•°**ï¼Œåˆ™è‡ªåŠ¨éšå¼è°ƒç”¨ ***åŸºç±»*** çš„**æ‹·è´æ„é€ å‡½æ•°**ï¼›



- æ´¾ç”Ÿç±»çš„æ„é€ å‡½æ•°éœ€è¦ä½¿ç”¨åŸºç±»çš„**æœ‰å‚**æ„é€ å‡½æ•°ï¼Œå¿…é¡»**æ˜¾å¼**åœ¨**åˆå§‹åŒ–å™¨åˆ—è¡¨**ä¸­ç”³æ˜ã€‚ 

  æ³¨æ„ï¼š***ä¸èƒ½åœ¨æ„é€ å‡½æ•°å†…è°ƒç”¨ï¼***åªèƒ½åœ¨åˆå§‹åŒ–å™¨åˆ—è¡¨ä¸­è°ƒç”¨ã€‚



### æ´¾ç”Ÿç±»å¯¹è±¡çš„æ„é€ ä¸ææ„é¡ºåº

#### æ„é€ é¡ºåº

1. é¦–å…ˆè°ƒç”¨å…¶**åŸºç±»çš„æ„é€ å‡½æ•°**ï¼ˆå¤šé‡ç»§æ‰¿ï¼šè°ƒç”¨é¡ºåºæŒ‰ç…§åŸºç±»è¢«ç»§æ‰¿æ—¶çš„å£°æ˜é¡ºåºï¼ˆä»å·¦å‘å³ï¼‰ï¼‰ã€‚
2. ç„¶åè°ƒç”¨**æœ¬ç±»å¯¹è±¡ *æˆå‘˜* çš„æ„é€ å‡½æ•°**ï¼ˆè°ƒç”¨é¡ºåºæŒ‰ç…§å¯¹è±¡æˆå‘˜åœ¨ç±»ä¸­çš„å£°æ˜é¡ºåºï¼‰ã€‚
3. æœ€åè°ƒç”¨**æœ¬ç±»çš„æ„é€ å‡½æ•°**ã€‚

> [!TIP]
>
> ```cpp
> //å¤šé‡ç»§æ‰¿ä¾‹å­
> #include<iostream>
> using namespace std;
> 
> class X {
> public:
>     X() { cout << "X"; }
> };
> class Y {
> public:
>     Y() { cout << "Y"; }
> };
> class Z : public Y, public X {
> public:
>     Z() { cout << "Z"; }
> };
> int main() {
>     Z z;
> }
> ```
>
> è¾“å‡ºä¸ºï¼š`YXZ`



#### ææ„é¡ºåº

ä¸æ„é€ å‡½æ•°çš„è°ƒç”¨æ¬¡åºç›¸å  

1. é¦–å…ˆè°ƒç”¨**æœ¬ç±»çš„ææ„å‡½æ•°**
2. ç„¶åè°ƒç”¨**æœ¬ç±»å¯¹è±¡æˆå‘˜çš„ææ„å‡½æ•°**
3. æœ€åè°ƒç”¨å…¶**åŸºç±»çš„ææ„å‡½æ•°**

```c++
#include<iostream>
#include<string>
using namespace std;

class Base
{
public:
    Base()
    {
        cout<<"Constructor of Base"<<endl;
    }
    ~Base()
    {
        cout<<"Deconstructor of Base"<<endl;
    }
};

class Son: public Base
{
public:
    Son()
    {
        cout<<"Constructor of Son"<<endl;
    }
    ~Son()
    {
        cout<<"Deconstructor of Son"<<endl;
    }
};

void test()
{
    Son s1;
}

int main()
{
    test();
    return 0;
}
```

è¿è¡Œç»“æœ

```cmd
Constructor of Base
Constructor of Son
Deconstructor of Son
Deconstructor of Base
```



ç”±æ­¤å¯è§ï¼Œç»§æ‰¿æ—¶

å…ˆæ„é€ çˆ¶ç±»ï¼Œå†æ„é€ å­ç±»

å…ˆææ„å­ç±»ï¼Œå†ææ„çˆ¶ç±»



## æ´¾ç”Ÿç±» çš„newä¸delete

```cpp
#include<iostream>
using namespace std;

class A {
public:
    A() { cout << "A "; }
    ~A() { cout << "~A "; }
};
class B : public A {
public:
    B() { cout << "B "; }
    ~B() { cout << "~B "; }
};
int main() {
    A* p = new B();
    delete p;
}
```

è¾“å‡ºç»“æœä¸ºï¼š`A B ~A`

>è§£é‡Šï¼š
>
>`A* p = new B();`
>
>åˆ›å»º `B` å¯¹è±¡æ—¶ï¼ŒåŸºç±» `A` çš„æ„é€ å‡½æ•°å…ˆæ‰§è¡Œï¼ˆè¾“å‡º `A`ï¼‰ï¼Œç„¶åæ´¾ç”Ÿç±» `B` çš„æ„é€ å‡½æ•°æ‰§è¡Œï¼ˆè¾“å‡º `B`ï¼‰
>
>
>
>`delete p;`
>
>- åˆ é™¤çš„æ˜¯ `A*` æŒ‡é’ˆï¼Œä½†åŸºç±» `A` çš„ææ„å‡½æ•°**ä¸æ˜¯è™šå‡½æ•°**ï¼
>- æ‰€ä»¥åªä¼šè°ƒç”¨ `A` çš„ææ„å‡½æ•°ï¼Œ**ä¸ä¼šè°ƒç”¨ `B` çš„ææ„å‡½æ•°**ã€‚
>- æ‰€ä»¥è¾“å‡ºï¼š`~A`

å¦‚æœåœ¨ `~A() { cout << "~A "; }`å‰åŠ ä¸Š `virtual` ï¼Œä½¿å¾—åŸºç±» `A` çš„ææ„å‡½æ•°å˜æˆ**è™šå‡½æ•°**

è¾“å‡ºç»“æœä¸ºï¼š`A B ~B ~A`



## ç»§æ‰¿æ—¶è°ƒç”¨æˆå‘˜çš„é¡ºåº

### å¦‚æœæˆå‘˜ä¸åŒå

æ— è®ºæ˜¯ çˆ¶ç±»çš„æˆå‘˜ æˆ–æ˜¯ å­ç±»çš„æˆå‘˜

ç›´æ¥ç”¨ `ç±»å.æˆå‘˜å˜é‡å `æˆ–è€… `ç±»å.æˆå‘˜å‡½æ•°(...) `å°±å¯ä»¥è°ƒç”¨åˆ°ç›¸åº”çš„æˆå‘˜å˜é‡ æˆ– æˆå‘˜å‡½æ•°



### å¦‚æœæˆå‘˜åŒå

- è®¿é—®å­ç±»çš„åŒåæˆå‘˜ï¼Œ**ç›´æ¥è®¿é—®**å³å¯
- è®¿é—®çˆ¶ç±»çš„åŒåæˆå‘˜ï¼Œè¦åŠ **ä½œç”¨åŸŸ**



> [!IMPORTANT]
>
> **åŸå› è§£é‡Šï¼š**
>
> ä¸€æ—¦å‡ºç°**åŒåæˆå‘˜**ï¼Œå­ç±»ä¸­çš„åŒåæˆå‘˜ä¼š ***éšè—*** çˆ¶ç±»ä¸­**æ‰€æœ‰**çš„åŒåæˆå‘˜ï¼ˆåŒ…æ‹¬çˆ¶ç±»ä¸­å„ç§é‡è½½çš„æˆå‘˜å‡½æ•°ï¼Œåªè¦åŒåï¼Œä¸€å¾‹éšè—ï¼‰
>
> æ‰€ä»¥**ç›´æ¥è®¿é—®**åªèƒ½è®¿é—®åˆ°å­ç±»ä¸­çš„æˆå‘˜
>
> å¦‚æœè¦è®¿é—®çˆ¶ç±»çš„åŒåæˆå‘˜ï¼Œè¦åŠ **ä½œç”¨åŸŸ**



> [!NOTE]
>
> å¦‚æœæ˜¯**é™æ€æˆå‘˜**ï¼Œè¿˜å¯ä»¥é€šè¿‡**ç±»å**æ¥è®¿é—®
>
> - è®¿é—®å­ç±»çš„åŒåæˆå‘˜ï¼Œ`å­ç±»å::æˆå‘˜å˜é‡å` æˆ– `å­ç±»å::æˆå‘˜å‡½æ•°(...)`
> - è®¿é—®çˆ¶ç±»çš„åŒåæˆå‘˜ï¼Œ`å­ç±»å::çˆ¶ç±»å::æˆå‘˜å˜é‡å` æˆ– `å­ç±»å::çˆ¶ç±»å::æˆå‘˜å‡½æ•°(...)`



```c++
#include<iostream>
using namespace std;

class Base
{
public:
    int a;
    static int s_a;//é™æ€æˆå‘˜å˜é‡
    Base(){
        a=1;
    }

    void func()
    {
        cout<<"Base ä¸­çš„ void func()"<<endl;
    }
    void func(int x)
    {
        cout<<"Base ä¸­çš„ void func(int x)"<<endl;
    }

    static void s_func()//é™æ€æˆå‘˜å‡½æ•°
    {
        cout<<"Base ä¸­çš„ void s_func()"<<endl;
    }
};
int Base::s_a=11;

class Son:public Base
{
public:
    int a;
    static int s_a;//é™æ€æˆå‘˜å˜é‡
    Son(){
        a=2;
    }

    void func()
    {
        cout<<"Son ä¸­çš„ void func()"<<endl;
    }

    static void s_func()//é™æ€æˆå‘˜å‡½æ•°
    {
        cout<<"Son ä¸­çš„ void s_func()"<<endl;
    }
};
int Son::s_a=22;

int main()
{
    Son s1;

    //è®¿é—®éé™æ€æˆå‘˜
    //è®¿é—®éé™æ€æˆå‘˜å˜é‡
    cout<<"Sonä¸­çš„a: "<<s1.a<<endl;//è®¿é—®å­ç±»çš„åŒåæˆå‘˜å˜é‡
    cout<<"Baseä¸­çš„a: "<<s1.Base::a<<endl;//è®¿é—®çˆ¶ç±»çš„åŒåæˆå‘˜å˜é‡

    //è®¿é—®éé™æ€æˆå‘˜å‡½æ•°
    s1.func();//è®¿é—®å­ç±»çš„åŒåæˆå‘˜å‡½æ•°
    s1.Base::func();//è®¿é—®çˆ¶ç±»çš„åŒåæˆå‘˜å‡½æ•°
    s1.Base::func(100);//è®¿é—®çˆ¶ç±»çš„åŒåæˆå‘˜å‡½æ•°


    //è®¿é—®é™æ€æˆå‘˜
    //é€šè¿‡å¯¹è±¡æ¥è®¿é—®é™æ€æˆå‘˜å˜é‡
    cout<<"Sonä¸­çš„s_a: "<<s1.s_a<<endl;
    cout<<"Baseä¸­çš„s_a: "<<s1.Base::s_a<<endl;

    //é€šè¿‡ç±»åæ¥è®¿é—®é™æ€æˆå‘˜å˜é‡
    cout<<"Sonä¸­çš„s_a: "<<Son::s_a<<endl;
    cout<<"Baseä¸­çš„s_a: "<<Son::Base::s_a<<endl;

    //é€šè¿‡å¯¹è±¡æ¥è®¿é—®é™æ€æˆå‘˜å‡½æ•°
    s1.s_func();
    s1.Base::s_func();

    //é€šè¿‡ç±»åæ¥è®¿é—®é™æ€æˆå‘˜å‡½æ•°
    Son::s_func();
    Son::Base::s_func();
    return 0;
}
```



## å¤šç»§æ‰¿

ä½œç”¨ï¼šä¸€ä¸ªç±»ç»§æ‰¿å¤šä¸ªç±»

è¯­æ³•ï¼š`class å­ç±»åç§°: ç»§æ‰¿æ–¹å¼1 çˆ¶ç±»åç§°1, ç»§æ‰¿æ–¹å¼2 çˆ¶ç±»åç§°2,...  `

ä¾‹å¦‚ï¼š`class child: public base1, public base2, protected base3`

æ³¨æ„ï¼šå¦‚æœä¸¤ä¸ªçˆ¶ç±»ä¸­æœ‰åŒåçš„æˆå‘˜ï¼Œé‚£ä¹ˆåœ¨è°ƒç”¨æ—¶ï¼Œ**ä¸€å®šè¦åŠ ä½œç”¨åŸŸ**æ¥åŒºåˆ†

ä¾‹å¦‚ï¼šä¸‹é¢ä»£ç çš„å˜é‡aï¼ŒåŠ äº†ä½œç”¨åŸŸï¼Œèƒ½å¤Ÿæ­£ç¡®ç¼–è¯‘ï¼›è€Œå˜é‡bï¼Œæ²¡æœ‰åŠ ä½œç”¨åŸŸï¼Œç¼–è¯‘é”™è¯¯ï¼Œä¼šäº§ç”Ÿæ­§ä¹‰ï¼ˆä¸çŸ¥é“æŒ‡çš„æ˜¯å…·ä½“å“ªä¸€ä¸ªï¼‰ã€‚

```c++
/*å¤šé‡ç»§æ‰¿*/

#include<iostream>
using namespace std;

class Base1
{
public:
    int a;
    int b;
    Base1()
    {
        a=1;
        b=1;
    }
};

class Base2
{
public:
    int a;
    int b;
    Base2()
    {
        a=2;
        b=2;
    }
};

class Son:public Base1,public Base2
{
public:
    int c;
    Son(){
        c=3;
    }
};

int main()
{
    Son s1;
    
    cout<<"Base1ä¸­çš„a:"<<s1.Base1::a<<endl;
    cout<<"Base2ä¸­çš„a:"<<s1.Base2::a<<endl;
    // cout<<s1.b<<endl; //ç¼–è¯‘é”™è¯¯ï¼Œä¼šäº§ç”Ÿæ­§ä¹‰
    cout<<"c:"<<s1.c<<endl;
    return 0;
}
```

è¿è¡Œç»“æœï¼š

```cmd
Base1ä¸­çš„a:1
Base2ä¸­çš„a:2
c:3
```



## è±å½¢ç»§æ‰¿

ä¾‹å¦‚ï¼š

<img src="C++%E7%B1%BB%E7%9A%84%E7%AE%80%E4%BB%8B.assets/image-20250216001626852-1739636190615-1.png" alt="image-20250216001626852" style="zoom:67%;" />

```c++
#include<iostream>
using namespace std;

class Top
{
private:
    int data_private;
public: 
    int data_public;
};

//è™šç»§æ‰¿virtual
class Middle1:public Top {};

class Middle2:public Top{};

class Bottom: public Middle1, public Middle2{};

int main()
{
    Bottom st;
    //è±å½¢ç»§æ‰¿æ—¶ï¼Œä¸¤ä¸ªçˆ¶ç±»æ‹¥æœ‰ç›¸åŒçš„æ•°æ®ï¼Œéœ€è¦åŠ ä½œç”¨åŸŸæ¥åŒºåˆ†
    st.Middle1::data_public=20;
    st.Middle2::data_public=10;
    cout<<"st.Middle1::data_public is "<<st.Middle1::data_public<<endl;
    cout<<"st.Middle2::data_public is "<<st.Middle2::data_public<<endl;
    return 0;
}
```

è¿è¡Œç»“æœï¼š

```cmd
st.Middle1::a is 20
st.Middle2::a is 10
```



### è§£å†³æ–¹æ³•ï¼šè™šç»§æ‰¿

åœ¨ç»§æ‰¿è®¿é—®æ§åˆ¶å‰  åŠ ä¸Šå…³é”®å­—ï¼š***virtual***

```c++
#include<iostream>
using namespace std;

class Top
{
private:
    int data_private;
public: 
    int data_public;
};

//è™šç»§æ‰¿virtual
class Middle1:virtual public Top 
{

};

//è™šç»§æ‰¿virtual
class Middle2:virtual public Top
{

};

class Bottom: public Middle1, public Middle2
{

};

int main()
{
    Bottom st;
    //è±å½¢ç»§æ‰¿æ—¶ï¼Œä¸¤ä¸ªçˆ¶ç±»æ‹¥æœ‰ç›¸åŒçš„æ•°æ®ï¼Œéœ€è¦åŠ ä½œç”¨åŸŸæ¥åŒºåˆ†
    st.Middle1::data_public=20;
    st.Middle2::data_public=10;
    cout<<"st.Middle1::data_public is "<<st.Middle1::data_public<<endl;
    cout<<"st.Middle2::data_public is "<<st.Middle2::data_public<<endl;
    cout<<"st.data_public is "<<st.data_public<<endl;
    //ç„¶è€Œï¼Œè¿™ä»½æ•°æ®åªéœ€è¦1ä»½å°±å¤Ÿï¼Œè±å½¢ç»§æ‰¿ä¼šå¯¼è‡´æœ‰2ä»½æ•°æ®ï¼Œèµ„æºæµªè´¹
    return 0;
}
```

è¿è¡Œç»“æœï¼š

```cmd
st.Middle1::a is 10
st.Middle2::a is 10
st.a is 10
```



> [!IMPORTANT]
>
> **è™šç»§æ‰¿çš„æœ¬è´¨**ï¼š
>
> åœ¨Bottomç±»çš„å†…å­˜ä¸­ï¼Œ
>
> å…¶å®åªåˆ›å»º1ä¸ª `int a`
>
> å¦å¤–çš„ `Middle1`ï¼Œ `Middle2`ä½œç”¨åŸŸä¸‹çš„`a`ï¼Œç¼–è¯‘å™¨æŠŠä»–ä»¬éƒ½å®šä¹‰ä¸ºæŒ‡å‘ `int a`çš„æŒ‡é’ˆ
>
> 
>
> æ‰€ä»¥ï¼Œä»¥ä¸‹3ç§æ–¹å¼éƒ½æ˜¯åœ¨è®¿é—®**åŒä¸€å—å†…å­˜çš„æ•°æ®**
>
> - `st.Middle1::a`
> - `st.Middle2::a`
> - `st.a`



### è™šåŸºç±»åŠå…¶ä½¿ç”¨

> é€šè¿‡è™šç»§æ‰¿ï¼Œå³ åœ¨ç»§æ‰¿è®¿é—®æ§åˆ¶å‰æ·»åŠ ä¿ç•™å­—â€œ`virtual`â€  çš„åŸºç±»ï¼Œç§°ä¸ºâ€œè™šåŸºç±»â€ã€‚ï¼ˆä¸Šé¢çš„ä¾‹å­å°±æ˜¯è™šåŸºç±»ï¼‰

#### è™šåŸºç±»çš„ä½œç”¨

ï¼ˆè™šåŸºç±»çš„ä½œç”¨ï¼Œä¹Ÿå°±æ˜¯ `virtual`å…³é”®å­—çš„ä½œç”¨ï¼‰

ä¿è¯äº†è™šåŸºç±»çš„å”¯ä¸€å‰¯æœ¬åªè¢«åˆå§‹åŒ–ä¸€æ¬¡ï¼Œä»è€Œè¾¾åˆ°**å…±äº«**çš„æ•ˆæœã€‚

> æ™®é€šåŸºç±»ä¸è™šåŸºç±»ä¹‹é—´çš„å”¯ä¸€åŒºåˆ« ï¼šåªæœ‰åœ¨æ´¾ç”Ÿç±»é‡å¤ç»§æ‰¿äº†æŸä¸€åŸºç±»æ—¶æ‰è¡¨ç°å‡ºæ¥  



#### åˆ›å»ºæ´¾ç”Ÿç±»å¯¹è±¡æ—¶æ„é€ å‡½æ•°çš„è°ƒç”¨æ¬¡åºï¼š

1. æœ€å…ˆè°ƒç”¨**è™šåŸºç±»**çš„æ„é€ å‡½æ•°ï¼›
2. å…¶æ¬¡è°ƒç”¨**æ™®é€šåŸºç±»**çš„æ„é€ å‡½æ•°ï¼Œå¤šä¸ªåŸºç±»åˆ™æŒ‰æ´¾ç”Ÿç±»å£°æ˜æ—¶åˆ—å‡ºçš„æ¬¡åºã€**ä»å·¦åˆ°å³è°ƒç”¨**ï¼Œè€Œ**ä¸æ˜¯åˆå§‹åŒ–åˆ—è¡¨ä¸­çš„æ¬¡åº**ï¼›
3. å†æ¬¡è°ƒç”¨**å¯¹è±¡æˆå‘˜çš„æ„é€ å‡½æ•°**ï¼ŒæŒ‰ç±»å£°æ˜ä¸­å¯¹è±¡æˆå‘˜å‡ºç°çš„æ¬¡åºè°ƒç”¨ï¼Œè€Œä¸æ˜¯åˆå§‹åŒ–åˆ—è¡¨ä¸­çš„æ¬¡åº
4. æœ€åæ‰§è¡Œ**æ´¾ç”Ÿç±»**çš„æ„é€ å‡½æ•°ã€‚



#### ä½¿ç”¨çš„æ³¨æ„ç‚¹ï¼š

- è‹¥æ´¾ç”Ÿç±»æœ‰ä¸€ä¸ªè™šåŸºç±»ä½œä¸ºç¥–å…ˆç±»ï¼Œåˆ™åœ¨æ´¾ç”Ÿç±»æ„é€ å‡½æ•°ä¸­éœ€è¦åˆ—å‡ºå¯¹è™šåŸºç±»æ„é€ å‡½æ•°çš„è°ƒç”¨ï¼ˆå¦åˆ™ï¼Œè°ƒç”¨è™šåŸºç±»çš„é»˜è®¤æ„é€ å‡½æ•°ï¼‰
- å¯¹è™šåŸºç±»æ„é€ å‡½æ•°çš„è°ƒç”¨æ€»æ˜¯å…ˆäºæ™®é€šåŸºç±»çš„æ„é€ å‡½æ•°ã€‚



### è±å½¢ç»§æ‰¿çš„æ„é€ ã€ææ„é¡ºåº

```c++
#include<iostream>
using namespace std;

struct A { 
    A() { std::cout << "A "; } 
    ~A() { std::cout << "~A "; } 
};
struct B : virtual A { 
    B() { std::cout << "B "; }
    ~B(){std::cout<<"~B ";}
};
struct C : virtual A { 
    C() { std::cout << "C "; } 
    ~C() { std::cout << "~C "; } 
};
struct D : B, C { 
    D() { std::cout << "D "; } 
    ~D() { std::cout << "~D "; } 
};
int main() { D d; }

```

è¾“å‡ºç»“æœï¼š

```cpp
A B C D ~D ~C ~B ~A
```



## ç±»å‹å…¼å®¹æ€§

### 1.èµ‹å€¼è¿ç®—çš„ç±»å‹å…¼å®¹æ€§  

å¯ä»¥å°†åä»£ç±»çš„å¯¹è±¡èµ‹å€¼ç»™ç¥–å…ˆç±»å¯¹è±¡ï¼Œåä¹‹ä¸å¯  

```c++
Base base;
Son son;//Baseçš„å­ç±»
// son=base;//é”™è¯¯
base=son;//æ­£ç¡®
```



### 2.æŒ‡é’ˆçš„ç±»å‹å…¼å®¹æ€§

ç¥–å…ˆç±»çš„æŒ‡é’ˆ å­˜å‚¨ åä»£ç±»å¯¹è±¡çš„åœ°å€ï¼Œå¯ä»¥

åä»£ç±»çš„æŒ‡é’ˆ å­˜å‚¨ ç¥–å…ˆç±»å¯¹è±¡çš„åœ°å€ï¼Œä¸å¯ä»¥ï¼

```cpp
Base base;
Son son;//Baseçš„å­ç±»

Base* p_base;
Son* p_son;//Baseçš„å­ç±»

p_base=&base;//æ­£ç¡®
p_base=&son;//æ­£ç¡®ï¼ˆä¸Šè¡Œè½¬æ¢ï¼‰
// p_son=&base;//é”™è¯¯
p_son=&son;//æ­£ç¡®
```

### 3.ç±»å‹å…¼å®¹æ€§æ€»ç»“

æ´¾ç”Ÿç±»å…¼å®¹åŸºç±»ï¼šæ´¾ç”Ÿç±» å¯¹è±¡/æŒ‡é’ˆ => åŸºç±» å¯¹è±¡/æŒ‡é’ˆ :white_check_mark:  ï¼ˆä¸Šè¡Œè½¬æ¢ï¼‰

åŸºç±»ä¸å…¼å®¹æ´¾ç”Ÿç±»ï¼šåŸºç±» å¯¹è±¡/æŒ‡é’ˆ => æ´¾ç”Ÿç±» å¯¹è±¡/æŒ‡é’ˆ :x:



## ç±»å‹è½¬æ¢

### éšå¼è½¬æ¢è§„åˆ™

***å‘ä¸Šå…¼å®¹ï¼Œå‘åŸºç±»å…¼å®¹***

çˆ¶ç±»ä¸å¯ä»¥å‘å­ç±»è½¬æ¢

ä½†æ˜¯å­ç±»å¯ä»¥å‘çˆ¶ç±»è½¬æ¢



### æ˜¾å¼è½¬æ¢è§„åˆ™

#### 1. `dynamic_cast`

##### **ç”¨é€”**ï¼š

- è¿è¡Œæ—¶***å‘ä¸‹å…¼å®¹ï¼Œå‘æ´¾ç”Ÿç±»å…¼å®¹***
- **å¤šæ€ç±»å‹æ£€æŸ¥**ï¼šéªŒè¯å¯¹è±¡å®é™…ç±»å‹æ˜¯å¦ä¸ç›®æ ‡ç±»å‹å…¼å®¹ã€‚

> [!CAUTION]
>
> C++æœ¬èº«å°±æ”¯æŒä¸Šè¡Œè½¬æ¢ï¼ˆæ´¾ç”Ÿç±»æŒ‡é’ˆè½¬ä¸ºåŸºç±»æŒ‡é’ˆï¼‰
>
> ä½†æ˜¯è‹¥è¦ä¸‹è¡Œè½¬æ¢ï¼ˆåŸºç±»æŒ‡é’ˆè½¬æ´¾ç”Ÿç±»æŒ‡é’ˆï¼‰ï¼Œåˆ™éœ€è¦ç”¨`dynamic_cast`

##### **è¯­æ³•**ï¼š

```cpp
TargetType* p = dynamic_cast<TargetType*>(source_ptr);
```

##### **ç‰¹ç‚¹**ï¼š

- **è¿è¡Œæ—¶æ£€æŸ¥**ï¼šä¾èµ– RTTIï¼ˆRuntime Type Informationï¼‰éªŒè¯ç±»å‹å…¼å®¹æ€§ã€‚
- **å¤šæ€è¦æ±‚**ğŸŒŸï¼š`dynamic_cast` è¦æ±‚åŸºç±»æ˜¯å¤šæ€çš„ï¼ˆ**è‡³å°‘æœ‰ä¸€ä¸ªè™šå‡½æ•°**ï¼‰ï¼Œå¦åˆ™è¡Œä¸º**æœªå®šä¹‰**ã€‚
- **æ€§èƒ½å¼€é”€**ï¼šæ¯” `static_cast` æ…¢ï¼ˆæ¶‰åŠè¿è¡Œæ—¶ç±»å‹æŸ¥è¯¢ï¼‰ã€‚

##### è½¬æ¢æ–¹å‘ï¼šå‘ä¸Šã€å‘ä¸‹ã€ä¾§å‘

![image-20250522131311508](C++ç±»çš„ç®€ä»‹.assets/image-20250522131311508-1747890794695-1.png)

##### è½¬æ¢å¤±è´¥

è‹¥è½¬å‹å¤±è´¥ï¼š

ä¸” æ–°ç±»å‹ æ˜¯**æŒ‡é’ˆ**ç±»å‹ï¼Œåˆ™å®ƒè¿”å›è¯¥ç±»å‹çš„**ç©ºæŒ‡é’ˆ**ã€‚

ä¸” æ–°ç±»å‹ æ˜¯**å¼•ç”¨**ç±»å‹ï¼Œåˆ™å®ƒæŠ›å‡ºä¸ç±»å‹**std::bad_cast çš„å¤„ç†å—åŒ¹é…çš„*å¼‚å¸¸***

##### **ç¤ºä¾‹**ï¼š

```cpp
class Base {
public:
    virtual ~Base() {} // å¿…é¡»æœ‰å¤šæ€ï¼ˆè™šå‡½æ•°ï¼‰
};

class Derived : public Base {};

Base* base_ptr = new Derived();

// å®‰å…¨çš„å‘ä¸‹è½¬æ¢
Derived* derived_ptr = dynamic_cast<Derived*>(base_ptr);
if (derived_ptr) {
    // è½¬æ¢æˆåŠŸï¼Œå¯ä»¥å®‰å…¨ä½¿ç”¨
} else {
    // è½¬æ¢å¤±è´¥
}
```



#### **2. `static_cast`**

##### **ç”¨é€”**ï¼š

- **ç¼–è¯‘æ—¶ç±»å‹è½¬æ¢**ï¼šåœ¨ç¼–è¯‘æ—¶å®Œæˆç±»å‹æ£€æŸ¥ï¼Œä¸æ¶‰åŠè¿è¡Œæ—¶å¼€é”€ã€‚
- é€‚ç”¨èŒƒå›´ï¼š
  - **åŸºç¡€ç±»å‹è½¬æ¢**ï¼ˆå¦‚ `int` â†’ `double`ï¼Œ`enum` â†’ `int`ï¼‰ã€‚
  - **ç±»å±‚æ¬¡ç»“æ„ä¸­çš„ä¸Šè¡Œè½¬æ¢**ï¼ˆæ´¾ç”Ÿç±»æŒ‡é’ˆ/å¼•ç”¨ â†’ åŸºç±»æŒ‡é’ˆ/å¼•ç”¨ï¼‰ã€‚
  - **æ˜¾å¼ç±»å‹è½¬æ¢**ï¼ˆå¦‚ `void*` â†’ `T*`ï¼Œä½†éœ€å¼€å‘è€…ç¡®ä¿å®‰å…¨æ€§ï¼‰ã€‚
  - **ç›¸å…³ç±»å‹é—´çš„è½¬æ¢**ï¼ˆå¦‚ `int*` â†’ `void*` â†’ `float*`ï¼‰ã€‚

##### **è¯­æ³•**ï¼š

```cpp
TargetType* p = static_cast<TargetType*>(source_ptr);
```

##### **ç‰¹ç‚¹**ï¼š

- **æ— è¿è¡Œæ—¶æ£€æŸ¥**ï¼šè½¬æ¢çš„å®‰å…¨æ€§å®Œå…¨ç”±å¼€å‘è€…ä¿è¯ã€‚
- **å¼ºåˆ¶è½¬æ¢**ï¼šå³ä½¿ç±»å‹ä¸å…¼å®¹ï¼Œç¼–è¯‘å™¨ä¹Ÿå¯èƒ½å…è®¸è½¬æ¢ï¼ˆå¯èƒ½å¯¼è‡´æœªå®šä¹‰è¡Œä¸ºï¼‰ã€‚
- **é«˜æ•ˆ**ï¼šæ— è¿è¡Œæ—¶ç±»å‹ä¿¡æ¯ï¼ˆRTTIï¼‰å¼€é”€ã€‚

##### **ç¤ºä¾‹**ï¼š

```cpp
int a = 10;
double b = static_cast<double>(a); // åŸºç¡€ç±»å‹è½¬æ¢

Base* base_ptr = static_cast<Base*>(derived_ptr); // ä¸Šè¡Œè½¬æ¢ï¼ˆå®‰å…¨ï¼‰
```



#### 3.`const_cast`

åœ¨ C++ ä¸­ï¼Œ`const_cast` æ˜¯ä¸€ä¸ªç”¨äºæ“ä½œ `const` æˆ– `volatile` é™å®šç¬¦çš„ç±»å‹è½¬æ¢è¿ç®—ç¬¦ã€‚å®ƒä¸»è¦æœ‰ä»¥ä¸‹ä¸¤ä¸ªæ ¸å¿ƒç”¨é€”ï¼š

------

##### ç”¨é€”1ï¼šå»é™¤ `const` æˆ– `volatile` é™å®šç¬¦

- **ç”¨é€”**ï¼šå°† `const` æˆ– `volatile` ä¿®é¥°çš„å˜é‡è½¬æ¢ä¸ºéé™å®šç±»å‹ã€‚
- **åœºæ™¯**ï¼šå½“éœ€è¦ä¿®æ”¹ä¸€ä¸ªé€»è¾‘ä¸Šæœ¬åº”ä¸ºé `const` ä½†è¢«é”™è¯¯å£°æ˜ä¸º `const` çš„å˜é‡æ—¶ï¼ˆè°¨æ…ä½¿ç”¨ï¼‰ã€‚

###### ç¤ºä¾‹ä»£ç 

```cpp
void updateValue(int* ptr) {
    *ptr = 42; // éœ€è¦é const æŒ‡é’ˆ
}

int main() {
    const int x = 10;
    // updateValue(&x); // é”™è¯¯ï¼šæ— æ³•å°† const int* è½¬æ¢ä¸º int*
    
    int* px = const_cast<int*>(&x); // å»é™¤ const é™å®šç¬¦
    updateValue(px); // ç¼–è¯‘é€šè¿‡ï¼Œä½†ä¿®æ”¹ x ä¼šå¯¼è‡´æœªå®šä¹‰è¡Œä¸ºï¼ˆUBï¼‰ï¼
    // æ³¨æ„ï¼šx åŸä¸º constï¼Œæ­¤å¤„ä¿®æ”¹æ˜¯å±é™©çš„ï¼
}
```

##### ç”¨é€”2ï¼šæ·»åŠ  `const` æˆ– `volatile` é™å®šç¬¦

- **ç”¨é€”**ï¼šå°†é `const` æˆ–é `volatile` å˜é‡è½¬æ¢ä¸ºé™å®šç±»å‹ã€‚
- **åœºæ™¯**ï¼šå°†å˜é‡ä¼ é€’ç»™åªæ¥å— `const` å‚æ•°çš„å‡½æ•°ã€‚

###### ç¤ºä¾‹ä»£ç 

```cpp
void printValue(const int* ptr) {
    std::cout << *ptr << std::endl;
}

int main() {
    int x = 10;
    int* px = &x;
    printValue(px);          // éšå¼è½¬æ¢ï¼šint* â†’ const int*
    printValue(const_cast<const int*>(px)); // æ˜¾å¼æ·»åŠ  const
}
```

------

##### **æ ¸å¿ƒæ³¨æ„äº‹é¡¹**

1. **ä¸æ”¹å˜åº•å±‚å¯¹è±¡çš„å¸¸é‡æ€§**
   è‹¥åŸå§‹å¯¹è±¡æœ¬èº«æ˜¯ `const` çš„ï¼ˆå¦‚ `const int x = 10;`ï¼‰ï¼Œé€šè¿‡ `const_cast` å»é™¤ `const` åä¿®æ”¹å®ƒä¼šå¯¼è‡´ â€‹**â€‹æœªå®šä¹‰è¡Œä¸ºï¼ˆUBï¼‰â€‹**â€‹ã€‚

   ```cpp
   const int x = 10;
   int* px = const_cast<int*>(&x);
   *px = 20; // UBï¼šx æ˜¯çœŸæ­£çš„å¸¸é‡ï¼Œä¸å¯ä¿®æ”¹ï¼
   ```

2. **ä»…ç”¨äºæŒ‡é’ˆæˆ–å¼•ç”¨**
   `const_cast` ä¸èƒ½ç›´æ¥æ“ä½œå€¼ç±»å‹ï¼ˆå¦‚ `int`ï¼‰ï¼Œåªèƒ½ä½œç”¨äºæŒ‡é’ˆæˆ–å¼•ç”¨ï¼š

   ```cpp
   const int x = 10;
   int y = const_cast<int>(x); // é”™è¯¯ï¼šæ— æ³•è½¬æ¢å€¼ç±»å‹
   ```

3. **ä¸ç”¨äºè·¨ç±»å‹è½¬æ¢**
   `const_cast` åªèƒ½ä¿®æ”¹ `const`/`volatile` é™å®šç¬¦ï¼Œæ— æ³•è½¬æ¢å®é™…ç±»å‹ï¼š

   ```cpp
   const double* pd = nullptr;
   int* pi = const_cast<int*>(pd); // é”™è¯¯ï¼šç±»å‹ä¸åŒ¹é…
   ```



# å¤šæ€Polymorphism

## é‡è½½vsé‡å†™vséšè—

### **é‡è½½overloading**

å®šä¹‰ï¼šåœ¨**åŒä¸€ä½œç”¨åŸŸ**å†…ï¼Œ**å‡½æ•°å**éƒ½***ç›¸åŒ***ï¼Œä½†æ˜¯**å½¢å‚åˆ—è¡¨*ä¸åŒ***

æ˜“é”™ï¼šå‡½æ•°**æœ‰æ— constï¼Œä¹Ÿç®—æ˜¯é‡è½½**

æ³¨æ„ï¼š

- å‡½æ•°è¿”å›å€¼ç±»å‹ ä¸ é‡è½½æ— å…³
- ç±»çš„é™æ€æˆå‘˜å‡½æ•°ä¸æ™®é€šæˆå‘˜å‡½æ•°å¯ä»¥å½¢æˆé‡è½½



### **éšè— overwriting**

å®šä¹‰ï¼š**ä¸åŒä½œç”¨åŸŸ**ä¸­ï¼Œå®šä¹‰çš„**åŒåå‡½æ•°**æ„æˆéšè—

æ³¨æ„ï¼š

- ***ä¸è¦æ±‚*** **å‡½æ•°è¿”å›å€¼**å’Œ**å‡½æ•°å‚æ•°ç±»å‹**ç›¸åŒ
- ä¸æ˜¯è™šå‡½æ•°
- åªè¦æ±‚**åŒå**

å®è´¨ï¼šåœ¨å‡½æ•°æŸ¥æ‰¾æ—¶ï¼Œåå­—æŸ¥æ‰¾å…ˆäºç±»å‹æ£€æŸ¥ã€‚ç¼–è¯‘å™¨é¦–å…ˆåœ¨ç›¸åº”ä½œç”¨åŸŸä¸­æŸ¥æ‰¾å‡½æ•°ï¼Œå¦‚æœæ‰¾åˆ°åå­—ä¸€æ ·çš„åˆ™åœæ­¢æŸ¥æ‰¾ï¼›å¦‚æœæ²¡æœ‰æ‰¾åˆ°ï¼Œå†åˆ°å…¶ä»–ä½œç”¨åŸŸä¸­å»å¯»æ‰¾å…·æœ‰è¿™ä¸ªåå­—çš„å‡½æ•°



### **é‡å†™/è¦†ç›–overriding**

å®šä¹‰ï¼šæ´¾ç”Ÿç±»ä¸åŸºç±»ä¸­ï¼Œ**å‡½æ•°è¿”å›å€¼ç±»å‹ã€å‡½æ•°åã€å½¢å‚åˆ—è¡¨**å…¨éƒ¨éƒ½***ç›¸åŒ*** çš„è™šå‡½æ•°ï¼Œæ„æˆè™šå‡½æ•°é‡å†™/è™šå‡½æ•°é‡è½½

æ³¨æ„ï¼š

- å¿…é¡»æ˜¯**è™šå‡½æ•°**ï¼Œå³ï¼šåŸºç±»æˆ–éç›´æ¥åŸºç±»ä¸­ï¼Œè‡³å°‘æœ‰ä¸€ä¸ªæˆå‘˜å‡½æ•°è¢« **virtual** ä¿®é¥° 

ä½œç”¨ï¼š**æ´¾ç”Ÿç±»**å¯¹è±¡æŒ‡é’ˆï¼ˆæˆ–å¼•ç”¨ï¼‰è¢«è½¬å‹åˆ°**åŸºç±»**æŒ‡é’ˆï¼ˆæˆ–å¼•ç”¨ï¼‰ï¼Œå¦‚æœæœ‰å‡½æ•°**è¦†ç›–**ï¼Œåˆ™è°ƒç”¨**è¯¥æ´¾ç”Ÿç±»å¯¹è±¡**çš„è™šå‡½æ•°ï¼Œè€Œä¸æ˜¯è°ƒç”¨**åŸºç±»**çš„è™šå‡½æ•°ï¼›å¦‚æœæ²¡æœ‰å‡½æ•°**è¦†ç›–**ï¼Œåˆ™åªèƒ½è°ƒç”¨**åŸºç±»**çš„å‡½æ•°ã€‚



å…·ä½“ä»£ç ç¤ºä¾‹ï¼š

```cpp
//...
void do_print1(Base &b)//åŸºç±»å¼•ç”¨
{
    b.print();
}
//...
int main()
{
    Base b1;
    Derived d1;

    do_print1(b1);
    do_print1(d1);
}
```

ä»£ç åˆ†æï¼š

- å¦‚æœprint()æ˜¯è™šå‡½æ•°ï¼Œåˆ™æ´¾ç”Ÿç±»çš„`print()`å‡½æ•°**é‡å†™**åŸºç±»çš„`print()`å‡½æ•°ï¼Œé‚£ä¹ˆ `do_print1(d1)`ä¼šè°ƒç”¨æ´¾ç”Ÿç±» `Derived`çš„print()å‡½æ•°ï¼›

- å¦‚æœprint()ä¸æ˜¯è™šå‡½æ•°ï¼Œåˆ™æ´¾ç”Ÿç±»çš„`print()`å‡½æ•°**éšè—**åŸºç±»çš„`print()`å‡½æ•°ï¼Œé‚£ä¹ˆ `do_print1(d1)`ä¼šï¼š
  1. å…ˆæŠŠ æ´¾ç”Ÿç±»æŒ‡é’ˆï¼ˆæˆ–å¼•ç”¨ï¼‰è½¬æ¢ä¸ºåŸºç±»æŒ‡é’ˆï¼ˆæˆ–å¼•ç”¨ï¼‰
  2.  ç„¶åè°ƒç”¨åŸºç±» `Base`çš„print()å‡½æ•°ï¼›



### ä¸‰è€…å¯¹æ¯”

|           | ä½œç”¨åŸŸ | æ˜¯å¦ä¸ºè™šå‡½æ•° | å‡½æ•°å | è¿”å›å€¼ | å½¢å‚åˆ—è¡¨ | å‡½æ•°ç­¾åï¼ˆå‡½æ•°å+å½¢å‚åˆ—è¡¨ï¼‰ |
| :-------: | :----: | :----------: | :----: | :----: | :------: | :-------------------------: |
|   é‡è½½    |   åŒ   |     å‡å¯     |   åŒ   |  å‡å¯  |   ä¸åŒ   |            ä¸åŒ             |
|   éšè—    |  ä¸åŒ  |      å¦      |   åŒ   |  å‡å¯  |   å‡å¯   |            å‡å¯             |
| è¦†ç›–/é‡å†™ |  ä¸åŒ  |      æ˜¯      |   åŒ   |   åŒ   |    åŒ    |             åŒ              |



> [!NOTE]
>
> **å‡½æ•°ç­¾åï¼ˆFunction Signatureï¼‰**æŒ‡å‡½æ•°çš„åç§°åŠå…¶å‚æ•°ç±»å‹çš„ç»„åˆã€‚
>
> ç»„æˆéƒ¨åˆ†ï¼š
>
> - å‡½æ•°åç§°
> - å‚æ•°ç±»å‹ï¼šå‡½æ•°å‚æ•°çš„ç±»å‹åˆ—è¡¨ï¼ŒåŒ…æ‹¬å‚æ•°çš„é¡ºåºã€‚
>
> ä¸åŒ…æ‹¬ï¼š
>
> - ä¸åŒ…æ‹¬è¿”å›ç±»å‹
> - ä¹Ÿä¸åŒ…æ‹¬å‚æ•°çš„åå­—ã€‚
>
> ä½œç”¨ï¼šå‡½æ•°ç­¾åç”¨äºæ ‡è¯†å’ŒåŒºåˆ†ä¸åŒçš„å‡½æ•°ã€‚ä¸¤ä¸ªå‡½æ•°å¦‚æœåç§°ç›¸åŒä¸”å‚æ•°ç±»å‹ï¼ˆåŠå…¶é¡ºåºï¼‰ç›¸åŒï¼Œé‚£ä¹ˆå®ƒä»¬çš„å‡½æ•°ç­¾åæ˜¯ç›¸åŒçš„ã€‚



ç¤ºä¾‹ï¼š

```cpp
/*è¦†ç›–/é‡å†™ override,ä¸é‡è½½overload*/

#include<iostream>
using namespace std;

class Base{
public:
    virtual void print();
};
void Base::print()
{
    cout<<"Base"<<endl;
}

class Derived:public Base{
public:
    void print();
};
void Derived::print()
{
    cout<<"Derived"<<endl;
}
void do_print1(Base &b)
{
    b.print();   
}
void do_print2(Derived &d)
{
    d.print();
}

int main()
{
    Base b1;
    Derived d1;
    cout<<"============do_print1=============="<<endl;
    do_print1(b1);//æ­£ç¡®
    do_print1(d1);//æ­£ç¡®
    cout<<"==================================="<<endl;

    cout<<"============do_print2=============="<<endl;
    // do_print2(b1);//æŠ¥é”™
    do_print2(d1);//æ­£ç¡®
    cout<<"==================================="<<endl;

    return 0;
}
```



```python
/*è¦†ç›–/é‡å†™ override*/

#include<iostream>
using namespace std;

class Base{
public:
    virtual void print();//è™šå‡½æ•°
};
void Base::print()
{
    cout<<"Base"<<endl;
}

class Derived:public Base{
public:
    void print();
};
void Derived::print()
{
    cout<<"Derived"<<endl;
}
void do_print1(Base &b)
{
    b.print();   
}
void do_print2(Derived &d)
{
    d.print();
}

int main()
{
    Base b1;
    Derived d1;
    cout<<"============do_print1=============="<<endl;
    do_print1(b1);//æ­£ç¡®
    do_print1(d1);//æ­£ç¡®
    cout<<"==================================="<<endl;

    cout<<"============do_print2=============="<<endl;
    // do_print2(b1);//æŠ¥é”™
    do_print2(d1);//æ­£ç¡®
    cout<<"==================================="<<endl;

    return 0;
}
```



## è™šå‡½æ•°

è¯­æ³•ï¼šåœ¨å‡½æ•°åå‰é¢åŠ  `virtual`

> [!CAUTION]
>
> 1.ç±»çš„é™æ€æˆå‘˜å‡½æ•° ***ä¸*** èƒ½æ˜¯ è™šå‡½æ•°ï¼Œå› ä¸ºè™šå‡½æ•°æ˜¯é€šè¿‡å¯¹è±¡æŒ‡é’ˆ `this` æ¥è°ƒç”¨çš„ã€‚
>
> 2.**æ„é€ å‡½æ•°ä¸èƒ½å£°æ˜ä¸ºè™šå‡½æ•°**
>
> åŸå› ï¼š
>
> - æ„é€ å‡½æ•°ç”¨äºåˆå§‹åŒ–å¯¹è±¡æœ¬èº«ï¼Œåœ¨å¯¹è±¡æ„é€ è¿‡ç¨‹ä¸­**è™šè¡¨å°šæœªå»ºç«‹**ï¼Œè™šæœºåˆ¶å°šæœªç”Ÿæ•ˆã€‚
> - è™šå‡½æ•°çš„å¤šæ€ä¾èµ–äºè™šè¡¨ï¼Œè€Œåœ¨æ„é€ é˜¶æ®µï¼Œè™šè¡¨è¿˜æœªå®Œå…¨è®¾ç½®å¥½
>
> ä½†æ˜¯ï¼Œæ„é€ å‡½æ•°ä¸­å¯ä»¥**è°ƒç”¨**è™šå‡½æ•°



### çº¯è™šå‡½æ•°

å®šä¹‰æ–¹å¼ï¼š

```cpp
virtual void draw() = 0; // çº¯è™šå‡½æ•°
```

> [!IMPORTANT]
>
> çº¯è™šå‡½æ•°ä¸æ™®é€šè™šå‡½æ•°åœ¨å®šä¹‰æ–¹å¼ä¸Šçš„å”¯ä¸€åŒºåˆ«ï¼šçº¯è™šå‡½æ•°è¦ä»¥ `=0`ç»“å°¾
>
> å…±åŒç‚¹ï¼šå¼€å¤´éƒ½æœ‰`virtual`

|                                    | çº¯è™šå‡½æ•°                                       | æ™®é€šè™šå‡½æ•° |
| ---------------------------------- | ---------------------------------------------- | ---------- |
| å®šä¹‰æ–¹å¼                           | æœ«å°¾æœ‰`=0`                                     | æœ«å°¾æ— `=0` |
| æ˜¯å¦å¿…é¡»åœ¨**æ´¾ç”Ÿç±»ä¸­é‡å†™**         | å¿…é¡»é‡å†™                                       | éšä¾¿       |
| å«æœ‰è¿™ç§å‡½æ•°çš„ç±»æ˜¯å¦å¯å®ä¾‹åŒ–ç±»å¯¹è±¡ | å«æœ‰çº¯è™šå‡½æ•°çš„ç±»æ˜¯**æŠ½è±¡ç±»**ï¼Œ**ä¸èƒ½å®ä¾‹åŒ–ï¼** | å¯ä»¥       |



çº¯è™šå‡½æ•°çš„**ç±»å†…å£°æ˜**ä¸­ **ä¸èƒ½åŒ…å« *å‡½æ•°ä½“***

```cpp
class Abstract {
    virtual void func() = 0 { /* å‡½æ•°ä½“ */ }  // é”™è¯¯ï¼šçº¯è™šå‡½æ•°ä¸èƒ½å®šä¹‰åœ¨ç±»å†…éƒ¨ï¼
};
```

çº¯è™šå‡½æ•°å¯ä»¥åœ¨**ç±»å¤– æä¾›å®šä¹‰**ï¼ˆä½œä¸ºé»˜è®¤è¡Œä¸ºç»™æ´¾ç”Ÿç±»è°ƒç”¨ï¼‰ï¼Œä½†ä¸å»ºè®®ç»™å®šä¹‰ã€‚

å¦‚æœ**ææ„å‡½æ•°**æ˜¯**çº¯è™šå‡½æ•°**ï¼Œåˆ™å¿…é¡»ç»™å®šä¹‰ï¼Œå¦åˆ™é“¾æ¥é”™è¯¯!

åŸå› ï¼šé˜²æ­¢å†…å­˜æ³„æ¼

æ¯”å¦‚ï¼š

```cpp
class Base {
public:
    virtual ~Base() = 0;
};
//  ææ„å‡½æ•°æ˜¯çº¯è™šå‡½æ•°ï¼Œå¿…é¡»ç»™å®šä¹‰
Base::~Base() {
    std::cout << "Base destructor\n";
}
```





### è™šææ„å‡½æ•°

- è™½ç„¶**ææ„å‡½æ•°æ˜¯ä¸ç»§æ‰¿**çš„ï¼Œä½†è‹¥åŸºç±»å£°æ˜å…¶ææ„å‡½æ•°ä¸º virtualï¼Œåˆ™æ´¾ç”Ÿçš„ææ„å‡½æ•°å§‹ç»ˆ**è¦†ç›–**å®ƒã€‚è¿™ä½¿å¾—å¯ä»¥é€šè¿‡**æŒ‡å‘åŸºç±»çš„æŒ‡é’ˆ** `delete` **åŠ¨æ€åˆ†é…çš„å¤šæ€ç±»å‹å¯¹è±¡ã€‚**
- ä»»ä½•åŒ…å«è™šå‡½æ•°çš„åŸºç±»çš„ææ„å‡½æ•°å¿…é¡»ä¸º**å…¬å¼€`public`ä¸”è™š`virtual`**ï¼Œæˆ–**å—ä¿æŠ¤`potected`ä¸”éè™š**ã€‚ å¦åˆ™å¾ˆå®¹æ˜“å¯¼è‡´å†…å­˜æ³„æ¼



## æŠ½è±¡ç±»

å®šä¹‰ï¼šåŒ…å«**è‡³å°‘ä¸€ä¸ªçº¯è™šå‡½æ•°**çš„ç±»ï¼Œå«ä½œâ€œ***æŠ½è±¡ç±»***â€

ï¼ˆè¿™ä¸ªçº¯è™šå‡½æ•°å¯ä»¥æ˜¯æŠ½è±¡ç±»è‡ªå·±**å®šä¹‰**çš„ï¼Œä¹Ÿå¯ä»¥æ˜¯**ç»§æ‰¿**è€Œæ¥çš„ï¼‰

```cpp
class Shape {//Shapeæ˜¯æŠ½è±¡ç±»
public:
    virtual void draw() = 0; // çº¯è™šå‡½æ•°
};
```

> [!CAUTION]
>
> - ***ä¸èƒ½*** ç›´æ¥**å®ä¾‹åŒ–**å¯¹è±¡ã€‚
> - æ´¾ç”Ÿç±»å¿…é¡»**å®ç° *æ‰€æœ‰* çº¯è™šå‡½æ•°**æ‰èƒ½å®ä¾‹åŒ–ã€‚
> - å¯ä»¥åŒ…å«æ™®é€šæˆå‘˜å‡½æ•°ã€æ•°æ®æˆå‘˜å’Œ**éçº¯è™šå‡½æ•°**  ï¼ˆæŠ½è±¡ç±»ä¸­ï¼Œå¹¶ä¸æ˜¯æ‰€æœ‰å‡½æ•°éƒ½æ˜¯çº¯è™šå‡½æ•°ï¼‰
> - **è™šææ„å‡½æ•°**ï¼šææ„å‡½æ•°åº”å£°æ˜ä¸º**è™šå‡½æ•°å¹¶æä¾›å®ç°**ï¼Œé¿å…èµ„æºæ³„æ¼



### æ¥å£

>C++ä¸­æ²¡æœ‰æ¥å£ï¼Œåªæ˜¯ä»¿ç…§Javaçš„æ¥å£å®ç°ç±»ä¼¼çš„æ•ˆæœã€‚

è¦æ±‚ï¼š

- æˆå‘˜å‡½æ•°***éƒ½***æ˜¯**çº¯è™šå‡½æ•°**
- å¯ä»¥åŒ…å«**é™æ€æˆå‘˜**ï¼Œä¸åŒ…å«ä»»ä½•è‡ªå·±çš„æ•°æ®
- å¯ä»¥æœ‰è™šææ„å‡½æ•°ï¼Œä½†ä¸éœ€è¦æ„é€ å‡½æ•°
- è¢«è™šç»§æ‰¿ä¿è¯å”¯ä¸€ï¼Œå¤šç»§æ‰¿ä¹Ÿä¸ä¼šå‘½åå†²çª

### æŠ½è±¡ç±»vsæ¥å£

|            | æŠ½è±¡ç±»                                        | æ¥å£                                         |
| ---------- | --------------------------------------------- | -------------------------------------------- |
| å‡½æ•°ç±»å‹   | **è‡³å°‘åŒ…å«1ä¸ªçº¯è™šå‡½æ•°**ï¼Œå¯ä»¥åŒ…å«æ™®é€šæˆå‘˜å‡½æ•° | **åªæœ‰çº¯è™šå‡½æ•°**                             |
| æˆå‘˜ç±»å‹   | éƒ½å¯ä»¥æœ‰                                      | é™¤äº†é™æ€æ•°æ®æˆå‘˜å¤–ï¼Œ**ä¸åŒ…å«éé™æ€æ•°æ®æˆå‘˜** |
| å¯å¦è¢«ç»§æ‰¿ | å¯ä»¥                                          | å¯ä»¥                                         |



## å¤šæ€çš„ç§ç±»

### 1.é™æ€å¤šæ€ï¼ˆç¼–è¯‘æ—¶å¤šæ€ï¼‰

1.**é‡è½½**ï¼ˆå…·ä½“è§å‰æ–‡çš„é‡è½½ï¼‰ï¼š**å‡½æ•°é‡è½½** å’Œ **è¿ç®—ç¬¦é‡è½½** å±äºé™æ€å¤šæ€ï¼Œå…±åŒç‰¹ç‚¹æ˜¯å¤ç”¨å‡½æ•°å

å‡½æ•°åœ°å€**æ—©**ç»‘å®šï¼Œå³ï¼š**ç¼–è¯‘**é˜¶æ®µç¡®å®šå‡½æ•°åœ°å€

2.**æ¨¡æ¿**

### 2.åŠ¨æ€å¤šæ€ï¼ˆè¿è¡Œæ—¶å¤šæ€ï¼‰

**é‡å†™**ï¼ˆå…·ä½“è§å‰æ–‡çš„é‡å†™ï¼‰ï¼šåˆ©ç”¨**æ´¾ç”Ÿç±»å’Œè™šå‡½æ•°**

å‡½æ•°åœ°å€**æ™š**ç»‘å®šï¼Œå³ï¼š**è¿è¡Œ**é˜¶æ®µç¡®å®šå‡½æ•°åœ°å€



ç¤ºä¾‹

```c++
#include<iostream>
using namespace std;

class Animal{
public:
    void bark()
    {
        cout<<"Animal is barking"<<endl;
    }
};

class Cat:public Animal
{
public:
    void bark()
    {
        cout<<"Cat is barking"<<endl;
    }
};

//åœ°å€æ—©ç»‘å®šï¼Œå³åœ¨ç¼–è¯‘é˜¶æ®µå°±å·²ç»ç¡®å®šäº†å‡½æ•°çš„åœ°å€
void doBark1(Animal & animal) //cppä¸­ï¼Œå…è®¸çˆ¶ç±»ä¸å­ç±»ä¹‹é—´çš„è½¬æ¢ã€‚æ‰€ä»¥ï¼Œå¯ä»¥æœ‰Animal & animal=cat
{
    animal.bark();
}

int main()
{
    Cat cat;
    doBark1(cat);
    return 0;
}
```

è¿è¡Œç»“æœï¼š

```cmd
Animal is barking
```



> [!CAUTION]
>
> å°†ä¸Šè¿°ä»£ç è¿›è¡Œä»¥ä¸‹æ”¹åŠ¨ï¼š
>
> - åœ¨çˆ¶ç±»`Animal`çš„`bark`å‡½æ•°å·¦è¾¹ï¼ŒåŠ ä¸Švirtualå…³é”®å­—ï¼Œå˜æˆ**è™šå‡½æ•°**
>
> å…¶ä»–ä¸å˜
>
> å³å¯å®ç°**åŠ¨æ€å¤šæ€**



```c++
#include<iostream>
using namespace std;

class Animal{
public:
    virtual void bark()//åœ¨æœ€å·¦è¾¹åŠ ä¸Švirtualå…³é”®å­—ï¼Œå˜æˆè™šå‡½æ•°
    {
        cout<<"Animal is barking"<<endl;
    }
};

class Cat:public Animal
{
public:
    void bark()
    {
        cout<<"Cat is barking"<<endl;
    }
};

//åŠ¨æ€å¤šæ€ï¼Œåœ°å€æ™šç»‘å®šï¼Œå³åœ¨è¿è¡Œé˜¶æ®µç¡®å®šäº†å‡½æ•°çš„åœ°å€
void doBark2(Animal & animal) //cppä¸­ï¼Œå…è®¸çˆ¶ç±»ä¸å­ç±»ä¹‹é—´çš„è½¬æ¢ã€‚æ‰€ä»¥ï¼Œå¯ä»¥æœ‰Animal & animal=cat
{
    animal.bark();
}

int main()
{
    Cat cat;
    doBark2(cat);//è°ƒç”¨çš„æ˜¯Catçš„bark()
    return 0;
}
```

è¿è¡Œç»“æœï¼š

```cmd
Cat is barking
```



## ä¸å¤šæ€ç›¸å…³çš„å…³é”®å­—

### `=0`

```cpp
virtual double calculatePower() const = 0;
```

`=0`ï¼šè¡¨ç¤ºè¿™æ˜¯ä¸€ä¸ª**çº¯è™šå‡½æ•°**ï¼Œæ²¡æœ‰å®ç°ï¼Œéœ€è¦**å­ç±»å®ç°å®ƒ**

### `override`

ä½œç”¨ï¼šå¦‚æœç”¨`override`æ ‡è®°äº†æŸä¸ªå‡½æ•°ï¼Œä½†è¯¥å‡½æ•°å¹¶æ²¡æœ‰è¦†ç›–å·²å­˜åœ¨çš„è™šå‡½æ•°ï¼Œæ­¤æ—¶ç¼–è¯‘å™¨å°†æŠ¥é”™

æ³¨æ„ï¼šç”¨äºæ´¾ç”Ÿç±»ä¸­

```cpp
class B
{
	virtual void f1( int ) const;
	virtual void f2();
	void f3();
};
class C : B
{
	void f1( int ) const override;	//æ­£ç¡®ï¼Œf1ä¸åŸºç±»ä¸­çš„f1åŒ¹é…
	void f2( int ) override;		//é”™è¯¯ï¼šBæ²¡æœ‰å½¢å¦‚f2ï¼ˆintï¼‰çš„å‡½æ•°
	void f3() override;				//é”™è¯¯ï¼šf3ä¸æ˜¯è™šå‡½æ•°
	void f4() override;				//é”™è¯¯ï¼šBä¸­æ²¡æœ‰åä¸ºf4çš„å‡½æ•°
};

```



### `final`

ä½œç”¨ï¼š

1.æŒ‡å®šæŸä¸ª**è™šå‡½æ•°** ä¸èƒ½åœ¨å­ç±»ä¸­è¢«è¦†ç›–ï¼Œ

2.æˆ–è€…æŸä¸ª**ç±»** ä¸èƒ½è¢«å­ç±»ç»§æ‰¿ã€‚ 

![image-20250522135012416](C++ç±»çš„ç®€ä»‹.assets/image-20250522135012416-1747893015361-3.png)



### `typeid`

```cpp
#include <iostream>
#include <typeinfo>

class Base { virtual void func() {} };     // å¤šæ€åŸºç±»
class Derived : public Base {};            // æ´¾ç”Ÿç±»

int main() {
    Base* ptr = new Derived();
    std::cout << typeid(ptr).name() << std::endl;
    std::cout << typeid(*ptr).name() << std::endl;
    return 0;
}
```

>***è§£æï¼š***
>
>#### `typeid(ptr).name()`
>
>- `ptr` æ˜¯ä¸€ä¸ª `Base*` ç±»å‹çš„**æŒ‡é’ˆ**ã€‚
>- ç¼–è¯‘æœŸç±»å‹å°±æ˜¯ `Base*`ï¼Œå› æ­¤è¾“å‡ºçš„æ˜¯ **`P4Base`**ï¼ˆè¡¨ç¤º "pointer to Base"ï¼Œ`P` = pointerï¼Œ`4Base` = Base ç±»åé•¿åº¦+åç§°ï¼‰ã€‚
>- **ä¸å¯¹è±¡å®é™…ç±»å‹æ— å…³**ã€‚
>
>#### `typeid(*ptr).name()`
>
>- ç”±äº `Base` æœ‰ **è™šå‡½æ•°**ï¼Œè¿™æ˜¯ä¸€ä¸ª **å¤šæ€ç±»å‹**ã€‚
>- æ‰€ä»¥ `typeid(*ptr)` ä¼šè§¦å‘ **RTTIï¼ˆè¿è¡Œæ—¶ç±»å‹è¯†åˆ«ï¼‰**ã€‚
>- `*ptr` å®é™…ä¸ŠæŒ‡å‘çš„æ˜¯ä¸€ä¸ª `Derived` ç±»å‹**å¯¹è±¡**ï¼Œå› æ­¤è¾“å‡ºçš„æ˜¯ **`7Derived`**ï¼ˆè¡¨ç¤ºç±»åé•¿åº¦+åç§°ï¼‰ã€‚
